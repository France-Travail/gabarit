
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../model_class/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Model aggregation - Gabarit documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#template_nlp.models_training.model_aggregation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Gabarit documentation" class="md-header__button md-logo" aria-label="Gabarit documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Gabarit documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Model aggregation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OSS-Pole-Emploi/gabarit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OSS-Pole-Emploi/gabarit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Gabarit documentation" class="md-nav__button md-logo" aria-label="Gabarit documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Gabarit documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OSS-Pole-Emploi/gabarit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OSS-Pole-Emploi/gabarit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../frameworks/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Frameworks
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Frameworks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frameworks/NLP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frameworks/NUM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NUM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frameworks/VISION/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VISION
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frameworks/API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Template api
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Template api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/core/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/core/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/core/logtools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logtools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/core/resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/model/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Model
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/model/model_base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/model/model_gabarit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model gabarit
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/routers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Routers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            Routers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/technical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/routers/schemas/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Schemas
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4_3" id="__nav_3_1_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4_3">
            <span class="md-nav__icon md-icon"></span>
            Schemas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/schemas/functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/schemas/technical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/schemas/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Template nlp
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Template nlp
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models training
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Models training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Model aggregation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Model aggregation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation" class="md-nav__link">
    model_aggregation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation" class="md-nav__link">
    ModelAggregation
  </a>
  
    <nav class="md-nav" aria-label="ModelAggregation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.aggregation_function" class="md-nav__link">
    aggregation_function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.sub_models" class="md-nav__link">
    sub_models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.predict_proba" class="md-nav__link">
    predict_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.all_predictions" class="md-nav__link">
    all_predictions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.majority_vote" class="md-nav__link">
    majority_vote()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.proba_argmax" class="md-nav__link">
    proba_argmax()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.vote_labels" class="md-nav__link">
    vote_labels()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../model_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../model_huggingface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model huggingface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../utils_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../hf_metrics/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Hf metrics
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2_5" id="__nav_3_2_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_5">
            <span class="md-nav__icon md-icon"></span>
            Hf metrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hf_metrics/accuracy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accuracy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hf_metrics/f1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    F1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hf_metrics/precision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Precision
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hf_metrics/recall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recall
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../models_sklearn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models sklearn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2_6" id="__nav_3_2_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            Models sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model pipeline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_tfidf_gbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf gbt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_tfidf_lgbm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf lgbm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_tfidf_sgdc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf sgdc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_tfidf_svm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf svm
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../models_tensorflow/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models tensorflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2_7" id="__nav_3_2_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            Models tensorflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_cnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding cnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_lstm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding lstm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_lstm_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding lstm attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_lstm_gru/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding lstm gru
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_lstm_structured_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding lstm structured attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_tfidf_dense/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf dense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/utils_deep_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils deep keras
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../monitoring/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/mlflow_logger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mlflow logger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/model_explainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model explainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../preprocessing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/preprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocess
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Template num
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Template num
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models training
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            Models training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/model_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/model_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/model_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model pipeline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/utils_deep_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils deep keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/utils_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/classifiers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Classifiers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_6" id="__nav_3_3_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_6">
            <span class="md-nav__icon md-icon"></span>
            Classifiers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/model_aggregation_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model aggregation classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/model_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/model_xgboost_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model xgboost classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_6_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/classifiers/models_sklearn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models sklearn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_6_4" id="__nav_3_3_2_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_2_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_6_4">
            <span class="md-nav__icon md-icon"></span>
            Models sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_gbt_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model gbt classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_knn_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model knn classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_lgbm_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model lgbm classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_logistic_regression_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model logistic regression classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_rf_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model rf classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_ridge_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model ridge classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_sgd_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model sgd classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_svm_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model svm classifier
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_6_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/classifiers/models_tensorflow/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models tensorflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_6_5" id="__nav_3_3_2_6_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_2_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_6_5">
            <span class="md-nav__icon md-icon"></span>
            Models tensorflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_tensorflow/model_dense_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model dense classifier
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/regressors/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Regressors
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_7" id="__nav_3_3_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_7">
            <span class="md-nav__icon md-icon"></span>
            Regressors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/model_aggregation_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model aggregation regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/model_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/model_xgboost_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model xgboost regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_7_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/regressors/models_sklearn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models sklearn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_7_4" id="__nav_3_3_2_7_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_2_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_7_4">
            <span class="md-nav__icon md-icon"></span>
            Models sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_bayesian_ridge_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model bayesian ridge regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_elasticnet_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model elasticnet regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_gbt_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model gbt regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_kernel_ridge_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model kernel ridge regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_knn_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model knn regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_lgbm_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model lgbm regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_pls_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model pls regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_rf_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model rf regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_sgd_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model sgd regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_svr_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model svr regressor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_7_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/regressors/models_tensorflow/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models tensorflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_7_5" id="__nav_3_3_2_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_2_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_7_5">
            <span class="md-nav__icon md-icon"></span>
            Models tensorflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_tensorflow/model_dense_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model dense regressor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/monitoring/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/monitoring/mlflow_logger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mlflow logger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/monitoring/model_explainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model explainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/preprocessing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_4" id="__nav_3_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_4">
            <span class="md-nav__icon md-icon"></span>
            Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/preprocessing/column_preprocessors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Column preprocessors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/preprocessing/outlier_detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outlier detection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/preprocessing/preprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocess
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Template vision
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Template vision
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/models_training/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models training
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            Models training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/model_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/model_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/utils_deep_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils deep keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/utils_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/models_training/classifiers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Classifiers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_2_5" id="__nav_3_4_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_4_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2_5">
            <span class="md-nav__icon md-icon"></span>
            Classifiers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/classifiers/model_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/classifiers/model_cnn_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model cnn classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/classifiers/model_transfer_learning_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model transfer learning classifier
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/models_training/object_detectors/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Object detectors
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_2_6" id="__nav_3_4_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_4_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2_6">
            <span class="md-nav__icon md-icon"></span>
            Object detectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/model_detectron_faster_rcnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model detectron faster rcnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/model_keras_faster_rcnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model keras faster rcnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/model_object_detector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model object detector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/utils_faster_rcnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils faster rcnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/utils_object_detectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils object detectors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/monitoring/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_3">
            <span class="md-nav__icon md-icon"></span>
            Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/monitoring/mlflow_logger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mlflow logger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/monitoring/model_explainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model explainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/preprocessing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_4" id="__nav_3_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_4">
            <span class="md-nav__icon md-icon"></span>
            Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/preprocessing/manage_white_borders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage white borders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/preprocessing/preprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocess
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation" class="md-nav__link">
    model_aggregation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation" class="md-nav__link">
    ModelAggregation
  </a>
  
    <nav class="md-nav" aria-label="ModelAggregation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.aggregation_function" class="md-nav__link">
    aggregation_function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.sub_models" class="md-nav__link">
    sub_models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.predict_proba" class="md-nav__link">
    predict_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.ModelAggregation.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.all_predictions" class="md-nav__link">
    all_predictions()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.majority_vote" class="md-nav__link">
    majority_vote()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.proba_argmax" class="md-nav__link">
    proba_argmax()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_aggregation.vote_labels" class="md-nav__link">
    vote_labels()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Model aggregation</h1>

<div class="doc doc-object doc-module">



<a id="template_nlp.models_training.model_aggregation"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="template_nlp.models_training.model_aggregation.ModelAggregation" class="doc doc-heading">
          <code>ModelAggregation</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="template_nlp.models_training.model_class.ModelClass" href="../model_class/#template_nlp.models_training.model_class.ModelClass">ModelClass</a></code></p>

  
      <p>Model for aggregating several instances of ModelClass</p>

            <details class="quote">
              <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">class</span> <span class="nc">ModelAggregation</span><span class="p">(</span><span class="n">ModelClass</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Model for aggregating several instances of ModelClass&#39;&#39;&#39;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">_default_name</span> <span class="o">=</span> <span class="s1">&#39;model_aggregation&#39;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">_dict_aggregation_function</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;majority_vote&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aggregation_function&#39;</span><span class="p">:</span> <span class="n">majority_vote</span><span class="p">,</span> <span class="s1">&#39;using_proba&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;multi_label&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                                  <span class="s1">&#39;proba_argmax&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aggregation_function&#39;</span><span class="p">:</span> <span class="n">proba_argmax</span><span class="p">,</span> <span class="s1">&#39;using_proba&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;multi_label&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                                  <span class="s1">&#39;all_predictions&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aggregation_function&#39;</span><span class="p">:</span> <span class="n">all_predictions</span><span class="p">,</span> <span class="s1">&#39;using_proba&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;multi_label&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                                  <span class="s1">&#39;vote_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;aggregation_function&#39;</span><span class="p">:</span> <span class="n">vote_labels</span><span class="p">,</span> <span class="s1">&#39;using_proba&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;multi_label&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_models</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">aggregation_function</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;majority_vote&#39;</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                 <span class="n">using_proba</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Initialization of the class (see ModelClass for more arguments)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        This model will aggregate the predictions of several model. The user can choose an aggregation function (with **kwargs if not using a list_classes arg)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        from existing ones, or create its own. All models must be either mono label or multi label, we do not accept mixes.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        However, we accept models that do not have the same class / labels. We will consider a meta model with joined classes / labels.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">            list_models (list) : The list of models to be aggregated (can be None if reloading from standalones)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">            aggregation_function (Callable or str) : The aggregation function used (custom function must use **kwargs if not using a list_classes arg)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">            using_proba (bool) : Which object is being aggregated (the probabilities or the predictions).</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">            ValueError: All the aggregated sub_models have not the same multi_label attributes</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">            ValueError: The multi_label attributes of the aggregated models are inconsistent with multi_label</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="c1"># Init.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="c1"># Get logger (must be done after super init)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="c1"># Set attributes</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span> <span class="o">=</span> <span class="n">using_proba</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span> <span class="o">=</span> <span class="n">aggregation_function</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="c1"># Manage submodels</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span> <span class="o">=</span> <span class="n">list_models</span>  <span class="c1"># Transform the list into a list of dictionnaries [{&#39;name&#39;: xxx, &#39;model&#39;: xxx}, ...]</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="c1"># Check for multi-labels inconsistencies</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">set_multi_label</span> <span class="o">=</span> <span class="p">{</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">multi_label</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">}</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">set_multi_label</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All the aggregated sub_models do not have the same multi_label attribute&quot;</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">set_multi_label</span><span class="o">.</span><span class="n">union</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">}))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The multi_label attributes of the aggregated models are inconsistent with the provided multi label attribute (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="c1"># Set trained &amp; classes info from submodels</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_trained</span><span class="p">()</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="c1"># Set nb_fit to 1 if already trained</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nb_fit</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">def</span> <span class="nf">aggregation_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Getter for aggregation_function&#39;&#39;&#39;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregation_function</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="nd">@aggregation_function</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">def</span> <span class="nf">aggregation_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agg_function</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Setter for aggregation_function</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        If a string, try to match a predefined function</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            ValueError: If the object aggregation_function is a str but not found in the dictionary of predefined aggregation functions</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            ValueError: If the object aggregation_function is incompatible with multi_label</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="c1"># Retrieve aggregation function from dict if a string</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">agg_function</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="c1"># Get infos</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="k">if</span> <span class="n">agg_function</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_aggregation_function</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The aggregation_function (</span><span class="si">{</span><span class="n">agg_function</span><span class="si">}</span><span class="s2">) is not a valid option (must be chosen in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict_aggregation_function</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">using_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_aggregation_function</span><span class="p">[</span><span class="n">agg_function</span><span class="p">][</span><span class="s1">&#39;using_proba&#39;</span><span class="p">]</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">multi_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_aggregation_function</span><span class="p">[</span><span class="n">agg_function</span><span class="p">][</span><span class="s1">&#39;multi_label&#39;</span><span class="p">]</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="n">agg_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_aggregation_function</span><span class="p">[</span><span class="n">agg_function</span><span class="p">][</span><span class="s1">&#39;aggregation_function&#39;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="c1"># Apply checks</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span> <span class="o">!=</span> <span class="n">using_proba</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;using_proba </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span><span class="si">}</span><span class="s2"> is incompatible with the selected aggregation function &#39;</span><span class="si">{</span><span class="n">agg_function</span><span class="si">}</span><span class="s2">&#39;. We force using_proba to </span><span class="si">{</span><span class="n">using_proba</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span> <span class="o">=</span> <span class="n">using_proba</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span> <span class="o">!=</span> <span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;multi_label </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="si">}</span><span class="s2"> is incompatible with the selected aggregation function &#39;</span><span class="si">{</span><span class="n">agg_function</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aggregation_function</span> <span class="o">=</span> <span class="n">agg_function</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="nd">@aggregation_function</span><span class="o">.</span><span class="n">deleter</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">def</span> <span class="nf">aggregation_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Deleter for aggregation_function&#39;&#39;&#39;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_aggregation_function</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">def</span> <span class="nf">sub_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Getter for sub_models&#39;&#39;&#39;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sub_models</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="nd">@sub_models</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">def</span> <span class="nf">sub_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_models</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Setter for sub_models</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            list_models (list) : The list of models to be aggregated</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">list_models</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">list_models</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">list_models</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">sub_models</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Init list of models</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">list_models</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="c1"># If a string (a model name), reload it</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="n">real_model</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">utils_models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="n">dict_model</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">real_model</span><span class="p">}</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="n">dict_model</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">model</span><span class="p">}</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">sub_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_model</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sub_models</span> <span class="o">=</span> <span class="n">sub_models</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="nd">@sub_models</span><span class="o">.</span><span class="n">deleter</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">def</span> <span class="nf">sub_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Deleter for sub_models&#39;&#39;&#39;</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sub_models</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">def</span> <span class="nf">_check_trained</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Checks and sets various attributes related to the fitting of underlying models</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            bool: is the aggregation model is considered fitted</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            list: list of classes</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            dict: dict of classes</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="c1"># Check fitted</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">models_trained</span> <span class="o">=</span> <span class="p">{</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">trained</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">}</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">models_trained</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">models_trained</span><span class="p">):</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="c1"># All models trained</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="n">trained</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="c1"># Set list_classes</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="n">list_classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">({</span><span class="n">label</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">list_classes</span><span class="p">})</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">list_classes</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="c1"># Set dict_classes based on self.list_classes</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">dict_classes</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">col</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_classes</span><span class="p">)}</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="c1"># No model or not fitted</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="n">trained</span><span class="p">,</span> <span class="n">list_classes</span><span class="p">,</span> <span class="n">dict_classes</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{}</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">return</span> <span class="n">trained</span><span class="p">,</span> <span class="n">list_classes</span><span class="p">,</span> <span class="n">dict_classes</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Fits the model</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">            x_train (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">            y_train (?): Array-like, shape = [n_samples, n_targets]</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            x_valid (?): Array-like, shape = [n_samples, n_features] - not used by sklearn models</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            y_valid (?): Array-like, shape = [n_samples, n_targets] - not used by sklearn models</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            with_shuffle (bool): If x, y must be shuffled before fitting - not used by sklearn models</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="c1"># Fit each model</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">trained</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="o">=</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="o">=</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">with_shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="c1"># Set nb_fit to 1 if not already trained</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nb_fit</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="c1"># Update attributes</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_trained</span><span class="p">()</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">data_agnostic_str_to_list</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">alternative_version</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Prediction</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            x_test (?): array-like or sparse matrix of shape = [n_samples, n_features]</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            return_proba (bool): If the function should return the probabilities instead of the classes</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            alternative_version (bool): If an alternative version (`tf.function` + `model.__call__`) must be used for Keras models. Should be faster with low nb of inputs.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            np.ndarray: array of shape = [n_samples]</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="c1"># We decide whether to rely on each model&#39;s probas or their predictions</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">if</span> <span class="n">return_proba</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="c1"># Get what we want (probas or preds) and use the aggregation function</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>                <span class="n">preds_or_probas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_probas_sub_models</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                <span class="n">preds_or_probas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_sub_models</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">list_classes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span> <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="n">preds_or_probas</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">data_agnostic_str_to_list</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Predicts the probabilities on the test set</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            x_test (?): array-like or sparse matrix of shape = [n_samples, n_features]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            alternative_version (bool): If an alternative version (`tf.function` + `model.__call__`) must be used for Keras models. Should be faster with low nb of inputs.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            np.ndarray: array of shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">probas_sub_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_probas_sub_models</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="c1"># The probas of all models are averaged</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">probas_sub_models</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">probas_sub_models</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">def</span> <span class="nf">_predict_probas_sub_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Recover the probabilities of each model being aggregated</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            x_test (?): array-like or sparse matrix of shape = [n_samples, n_features]</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            alternative_version (bool): If an alternative version (`tf.function` + `model.__call__`) must be used for Keras models. Should be faster with low nb of inputs.</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            np.ndarray: array of shape = [n_samples, nb_model, nb_classes]</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">array_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_predict_full_list_classes</span><span class="p">(</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">],</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                                 <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">])</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">array_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">array_probas</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="k">return</span> <span class="n">array_probas</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="k">def</span> <span class="nf">_predict_sub_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Recover the predictions of each model being aggregated</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">            x_test (?): array-like or sparse matrix of shape = [n_samples, n_features]</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            alternative_version (bool): If an alternative version (`tf.function` + `model.__call__`) must be used for Keras models. Should be faster with low nb of inputs.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            np.ndarray: not multi_label : array of shape = [n_samples, nb_model]</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">                        multi_label : array of shape = [n_samples, nb_model, n_classes]</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="n">array_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_predict_full_list_classes</span><span class="p">(</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">],</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                                      <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">])</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="n">array_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">array_predict</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="n">array_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">)</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">])</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="n">array_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">array_predict</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="k">return</span> <span class="n">array_predict</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="k">def</span> <span class="nf">_predict_full_list_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">ModelClass</span><span class="p">],</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">alternative_version</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;For multi_label: adds missing columns in the prediction of model (class missing in their list_classes)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        Or, if return_proba, adds a proba of zero to the missing classes in their list_classes</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            model (ModelClass): Model to use</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            x_test (?): Array-like or sparse matrix of shape = [n_samples, n_features]</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            return_proba (bool): If the function should return the probabilities instead of the classes</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">            alternative_version (bool): If an alternative version (`tf.function` + `model.__call__`) must be used for Keras models. Should be faster with low nb of inputs.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            np.ndarray: The array with the missing columns added</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="c1"># Get predictions or probas</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">preds_or_probas</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="o">=</span><span class="n">return_proba</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="c1"># Manage each cases. Reorder predictions or probas according to aggregation model list_classes</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="c1"># Multi label, proba = True</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="c1"># Multi label, proba = False</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="c1"># Mono label, proba = True</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">multi_label</span> <span class="ow">or</span> <span class="n">return_proba</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">preds_or_probas</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">))),</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>            <span class="n">df_model</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">preds_or_probas</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">list_classes</span><span class="p">:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="n">df_all</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_model</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="k">return</span> <span class="n">df_all</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="c1"># Mono label, proba = False</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">return</span> <span class="n">preds_or_probas</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Saves the model</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            json_data (dict): Additional configurations to be saved</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">if</span> <span class="n">json_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="n">json_data</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="c1"># Specific aggregation - save some wanted entries</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="n">train_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;filename_valid&#39;</span><span class="p">,</span> <span class="s1">&#39;preprocess_str&#39;</span><span class="p">]</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="n">default_json_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">json_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">train_keys</span><span class="p">}</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="n">default_json_data</span><span class="p">[</span><span class="s1">&#39;aggregator_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="c1"># Save each trained and unsaved model</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="n">path_config</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s1">&#39;configurations.json&#39;</span><span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_config</span><span class="p">):</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_config</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                    <span class="n">configs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                    <span class="n">trained</span> <span class="o">=</span> <span class="n">configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trained&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">trained</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                        <span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">default_json_data</span><span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">default_json_data</span><span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="c1"># Add some specific information</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="n">json_data</span><span class="p">[</span><span class="s1">&#39;list_models_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">]</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">json_data</span><span class="p">[</span><span class="s1">&#39;using_proba&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="c1"># Save aggregation_function if not None &amp; level_save &gt; LOW</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]):</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="c1"># Manage paths</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="n">aggregation_function_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s2">&quot;aggregation_function.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="c1"># Save as pickle</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">aggregation_function_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="c1"># Save</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="n">models_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">]</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="n">aggregation_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sub_models&quot;</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;aggregation_function&quot;</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">json_data</span><span class="o">=</span><span class="n">json_data</span><span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;aggregation_function&quot;</span><span class="p">,</span> <span class="n">aggregation_function</span><span class="p">)</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sub_models&quot;</span><span class="p">,</span> <span class="n">models_list</span><span class="p">)</span>  <span class="c1"># Setter needs list of models, not sub_models itself</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="c1"># Add message in model_upload_instructions.md</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">md_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;model_upload_instructions.md&quot;</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">   The aggregation model is a special model, please ensure that all sub-models and the aggregation model are manually saved together in order to be able to load it .  /!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_prepend_line</span><span class="p">(</span><span class="n">md_path</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="k">def</span> <span class="nf">_prepend_line</span><span class="p">(</span><span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39; Insert given string as a new line at the beginning of a file</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            file_name (str): Path to file</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            line (str): line to insert</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>            <span class="n">lines</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>            <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="k">def</span> <span class="nf">_hook_post_load_model_pkl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Manages a model specificities post load from a pickle file (i.e. not from standalone files)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            FileNotFoundError: If the aggregation_function file does not exist</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="c1"># Paths</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">aggregation_function_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s2">&quot;aggregation_function.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">configs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s1">&#39;configurations.json&#39;</span><span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="c1"># Manage errors</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">aggregation_function_path</span><span class="p">):</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t find aggregation_function file (</span><span class="si">{</span><span class="n">aggregation_function_path</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">configs_path</span><span class="p">):</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t find configuration file (</span><span class="si">{</span><span class="n">configs_path</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="c1"># Reload aggregation function</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">aggregation_function_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="c1"># Reload sub_models</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="n">configs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_configs</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">configs_path</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;list_models_name&#39;</span><span class="p">]</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="k">def</span> <span class="nf">_init_new_instance_from_configs</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Inits a new instance from a set of configurations</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">            configs: a set of configurations of a model to be reloaded</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">            ModelClass: the newly generated class</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="c1"># Call parent</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="n">model</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_init_new_instance_from_configs</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="c1"># Add attributes</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">model</span><span class="o">.</span><span class="n">sub_models</span> <span class="o">=</span> <span class="n">configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;list_models_name&#39;</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># Transforms the list into a list of dictionnaries [{&#39;name&#39;: xxx, &#39;model&#39;: xxx,}, ...]</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="c1"># Try to read the following attributes from configs and, if absent, keep the current one</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;using_proba&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)))</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="c1"># Return the new model</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="k">return</span> <span class="n">model</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="k">def</span> <span class="nf">_load_standalone_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default_model_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                               <span class="n">aggregation_function_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Loads standalone files for a newly created model via _init_new_instance_from_configs</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            default_model_dir (str): a path to look for default file paths</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">                                     If None, standalone files path should all be provided</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">            aggregation_function_path (str): Path to the aggregation function</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">                                             If None, we&#39;ll use the default path if default_model_dir is not None</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">            ValueError: If at least one path is not specified and can&#39;t be inferred</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">            FileNotFoundError: If the aggregation function path does not exist</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="c1"># Check if we are able to get all needed paths</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="k">if</span> <span class="n">default_model_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">aggregation_function_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Aggregation function path is not specified and can&#39;t be inferred&quot;</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="c1"># Retrieve file paths</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="k">if</span> <span class="n">aggregation_function_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="n">aggregation_function_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">default_model_dir</span><span class="p">,</span> <span class="s2">&quot;aggregation_function.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="c1"># Check paths exists</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">aggregation_function_path</span><span class="p">):</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can&#39;t find aggregation function path (</span><span class="si">{</span><span class="n">aggregation_function_path</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="c1"># Reload aggregation function</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">aggregation_function_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="template_nlp.models_training.model_aggregation.ModelAggregation.aggregation_function" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">aggregation_function</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-deletable"><code>deletable</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Getter for aggregation_function</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">




<h3 id="template_nlp.models_training.model_aggregation.ModelAggregation.sub_models" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sub_models</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-deletable"><code>deletable</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Getter for sub_models</p>
  </div>

</div>




<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_aggregation.ModelAggregation.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">list_models</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aggregation_function</span><span class="o">=</span><span class="s1">&#39;majority_vote&#39;</span><span class="p">,</span> <span class="n">using_proba</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialization of the class (see ModelClass for more arguments)
This model will aggregate the predictions of several model. The user can choose an aggregation function (with **kwargs if not using a list_classes arg)
from existing ones, or create its own. All models must be either mono label or multi label, we do not accept mixes.
However, we accept models that do not have the same class / labels. We will consider a meta model with joined classes / labels.</p>

<details class="kwargs" open>
  <summary>Kwargs</summary>
  <p>list_models (list) : The list of models to be aggregated (can be None if reloading from standalones)
aggregation_function (Callable or str) : The aggregation function used (custom function must use **kwargs if not using a list_classes arg)
using_proba (bool) : Which object is being aggregated (the probabilities or the predictions).</p>
</details>      <p>Raises:
    ValueError: All the aggregated sub_models have not the same multi_label attributes
    ValueError: The multi_label attributes of the aggregated models are inconsistent with multi_label</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_models</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">aggregation_function</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;majority_vote&#39;</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>             <span class="n">using_proba</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Initialization of the class (see ModelClass for more arguments)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    This model will aggregate the predictions of several model. The user can choose an aggregation function (with **kwargs if not using a list_classes arg)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    from existing ones, or create its own. All models must be either mono label or multi label, we do not accept mixes.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    However, we accept models that do not have the same class / labels. We will consider a meta model with joined classes / labels.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        list_models (list) : The list of models to be aggregated (can be None if reloading from standalones)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        aggregation_function (Callable or str) : The aggregation function used (custom function must use **kwargs if not using a list_classes arg)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        using_proba (bool) : Which object is being aggregated (the probabilities or the predictions).</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        ValueError: All the aggregated sub_models have not the same multi_label attributes</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        ValueError: The multi_label attributes of the aggregated models are inconsistent with multi_label</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="c1"># Init.</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="c1"># Get logger (must be done after super init)</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="c1"># Set attributes</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span> <span class="o">=</span> <span class="n">using_proba</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span> <span class="o">=</span> <span class="n">aggregation_function</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="c1"># Manage submodels</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span> <span class="o">=</span> <span class="n">list_models</span>  <span class="c1"># Transform the list into a list of dictionnaries [{&#39;name&#39;: xxx, &#39;model&#39;: xxx}, ...]</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="c1"># Check for multi-labels inconsistencies</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">set_multi_label</span> <span class="o">=</span> <span class="p">{</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">multi_label</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">}</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">set_multi_label</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All the aggregated sub_models do not have the same multi_label attribute&quot;</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">set_multi_label</span><span class="o">.</span><span class="n">union</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">}))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The multi_label attributes of the aggregated models are inconsistent with the provided multi label attribute (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="c1"># Set trained &amp; classes info from submodels</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_trained</span><span class="p">()</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="c1"># Set nb_fit to 1 if already trained</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nb_fit</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_aggregation.ModelAggregation.fit" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Fits the model</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_train</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_train</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_targets]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Kwargs:
    x_valid (?): Array-like, shape = [n_samples, n_features] - not used by sklearn models
    y_valid (?): Array-like, shape = [n_samples, n_targets] - not used by sklearn models
    with_shuffle (bool): If x, y must be shuffled before fitting - not used by sklearn models</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_valid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Fits the model</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        x_train (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        y_train (?): Array-like, shape = [n_samples, n_targets]</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        x_valid (?): Array-like, shape = [n_samples, n_features] - not used by sklearn models</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        y_valid (?): Array-like, shape = [n_samples, n_targets] - not used by sklearn models</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        with_shuffle (bool): If x, y must be shuffled before fitting - not used by sklearn models</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="c1"># Fit each model</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">trained</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">x_valid</span><span class="o">=</span><span class="n">x_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="o">=</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">with_shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="c1"># Set nb_fit to 1 if not already trained</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nb_fit</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="c1"># Update attributes</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_trained</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_aggregation.ModelAggregation.predict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Prediction</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_test</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array-like or sparse matrix of shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_proba</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the function should return the probabilities instead of the classes</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Kwargs:
    alternative_version (bool): If an alternative version (<code>tf.function</code> + <code>model.__call__</code>) must be used for Keras models. Should be faster with low nb of inputs.
Returns:
    np.ndarray: array of shape = [n_samples]</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="nd">@utils</span><span class="o">.</span><span class="n">data_agnostic_str_to_list</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">alternative_version</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Prediction</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        x_test (?): array-like or sparse matrix of shape = [n_samples, n_features]</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        return_proba (bool): If the function should return the probabilities instead of the classes</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        alternative_version (bool): If an alternative version (`tf.function` + `model.__call__`) must be used for Keras models. Should be faster with low nb of inputs.</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        np.ndarray: array of shape = [n_samples]</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="c1"># We decide whether to rely on each model&#39;s probas or their predictions</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">if</span> <span class="n">return_proba</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="c1"># Get what we want (probas or preds) and use the aggregation function</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span><span class="p">:</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">preds_or_probas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_probas_sub_models</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="n">preds_or_probas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_sub_models</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">list_classes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span> <span class="k">for</span> <span class="n">array</span> <span class="ow">in</span> <span class="n">preds_or_probas</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_aggregation.ModelAggregation.predict_proba" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Predicts the probabilities on the test set</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_test</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array-like or sparse matrix of shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Kwargs:
    alternative_version (bool): If an alternative version (<code>tf.function</code> + <code>model.__call__</code>) must be used for Keras models. Should be faster with low nb of inputs.
Returns:
    np.ndarray: array of shape = [n_samples, n_classes]</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="nd">@utils</span><span class="o">.</span><span class="n">data_agnostic_str_to_list</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Predicts the probabilities on the test set</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        x_test (?): array-like or sparse matrix of shape = [n_samples, n_features]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        alternative_version (bool): If an alternative version (`tf.function` + `model.__call__`) must be used for Keras models. Should be faster with low nb of inputs.</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        np.ndarray: array of shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">probas_sub_models</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_probas_sub_models</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">alternative_version</span><span class="o">=</span><span class="n">alternative_version</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="c1"># The probas of all models are averaged</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">probas_sub_models</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">probas_sub_models</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_aggregation.ModelAggregation.save" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">json_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Saves the model</p>

<details class="kwargs" open>
  <summary>Kwargs</summary>
  <p>json_data (dict): Additional configurations to be saved</p>
</details>
          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Saves the model</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        json_data (dict): Additional configurations to be saved</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">if</span> <span class="n">json_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">json_data</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="c1"># Specific aggregation - save some wanted entries</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="n">train_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;filename_valid&#39;</span><span class="p">,</span> <span class="s1">&#39;preprocess_str&#39;</span><span class="p">]</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="n">default_json_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">json_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">train_keys</span><span class="p">}</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">default_json_data</span><span class="p">[</span><span class="s1">&#39;aggregator_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="c1"># Save each trained and unsaved model</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="n">path_config</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s1">&#39;configurations.json&#39;</span><span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_config</span><span class="p">):</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_config</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="n">configs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="n">trained</span> <span class="o">=</span> <span class="n">configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trained&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">trained</span><span class="p">:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                    <span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">default_json_data</span><span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">default_json_data</span><span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="c1"># Add some specific information</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="n">json_data</span><span class="p">[</span><span class="s1">&#39;list_models_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">]</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">json_data</span><span class="p">[</span><span class="s1">&#39;using_proba&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">using_proba</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="c1"># Save aggregation_function if not None &amp; level_save &gt; LOW</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]):</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="c1"># Manage paths</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">aggregation_function_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s2">&quot;aggregation_function.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="c1"># Save as pickle</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">aggregation_function_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="c1"># Save</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="n">models_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub_model</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">sub_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_models</span><span class="p">]</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="n">aggregation_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregation_function</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sub_models&quot;</span><span class="p">)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;aggregation_function&quot;</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">json_data</span><span class="o">=</span><span class="n">json_data</span><span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;aggregation_function&quot;</span><span class="p">,</span> <span class="n">aggregation_function</span><span class="p">)</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sub_models&quot;</span><span class="p">,</span> <span class="n">models_list</span><span class="p">)</span>  <span class="c1"># Setter needs list of models, not sub_models itself</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="c1"># Add message in model_upload_instructions.md</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="n">md_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;model_upload_instructions.md&quot;</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>    <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">   The aggregation model is a special model, please ensure that all sub-models and the aggregation model are manually saved together in order to be able to load it .  /!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2">/!</span><span class="se">\\</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_prepend_line</span><span class="p">(</span><span class="n">md_path</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>



<div class="doc doc-object doc-function">




<h2 id="template_nlp.models_training.model_aggregation.all_predictions" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">all_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Calculates the sum of the arrays along axis 0 casts it to bool and then to int.
Expects a numpy array containing only zeroes and ones.
When used as an aggregation function, keeps all the prediction of each model (multi-labels)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>predictions</code></td>
          <td>
                <code>np.ndarray) </code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array of shape : (n_models, n_classes)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Return:
    np.ndarray: The prediction</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="k">def</span> <span class="nf">all_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Calculates the sum of the arrays along axis 0 casts it to bool and then to int.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Expects a numpy array containing only zeroes and ones.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    When used as an aggregation function, keeps all the prediction of each model (multi-labels)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        predictions (np.ndarray) : Array of shape : (n_models, n_classes)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    Return:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        np.ndarray: The prediction</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="template_nlp.models_training.model_aggregation.majority_vote" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">majority_vote</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Gives the class corresponding to the most present prediction in the given predictions.
In case of a tie, gives the prediction of the first model involved in the tie
Args:
    predictions (np.ndarray): The array containing the predictions of each model (shape (n_models))
Returns:
    The prediction</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="k">def</span> <span class="nf">majority_vote</span><span class="p">(</span><span class="n">predictions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gives the class corresponding to the most present prediction in the given predictions.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    In case of a tie, gives the prediction of the first model involved in the tie</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        predictions (np.ndarray): The array containing the predictions of each model (shape (n_models))</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        The prediction</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">labels</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">votes</span> <span class="o">=</span> <span class="p">[(</span><span class="n">label</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">counts</span><span class="p">)]</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">votes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">votes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">possible_classes</span> <span class="o">=</span> <span class="p">{</span><span class="n">vote</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">vote</span> <span class="ow">in</span> <span class="n">votes</span> <span class="k">if</span> <span class="n">vote</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">votes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]}</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">prediction</span> <span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predictions</span> <span class="k">if</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">possible_classes</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="template_nlp.models_training.model_aggregation.proba_argmax" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">proba_argmax</span><span class="p">(</span><span class="n">proba</span><span class="p">,</span> <span class="n">list_classes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Gives the class corresponding to the argmax of the average of the given probabilities</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>proba</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The probabilities of each model for each class, array of shape (nb_models, nb_classes)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>list_classes</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of classes</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    The prediction</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="k">def</span> <span class="nf">proba_argmax</span><span class="p">(</span><span class="n">proba</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">list_classes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gives the class corresponding to the argmax of the average of the given probabilities</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        proba (np.ndarray): The probabilities of each model for each class, array of shape (nb_models, nb_classes)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        list_classes (list): List of classes</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        The prediction</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">proba_average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">proba</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">proba</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">index_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">proba_average</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">return</span> <span class="n">list_classes</span><span class="p">[</span><span class="n">index_class</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="template_nlp.models_training.model_aggregation.vote_labels" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">vote_labels</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Gives the result of majority_vote applied on the second axis.
When used as an aggregation_function, for each class, performs a majority vote for the aggregated models.
It gives a multi-labels result</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>predictions</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>array of shape : (n_models, n_classes)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Return:
    np.ndarray: prediction</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_aggregation.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="k">def</span> <span class="nf">vote_labels</span><span class="p">(</span><span class="n">predictions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gives the result of majority_vote applied on the second axis.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    When used as an aggregation_function, for each class, performs a majority vote for the aggregated models.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    It gives a multi-labels result</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        predictions (np.ndarray): array of shape : (n_models, n_classes)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    Return:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        np.ndarray: prediction</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">majority_vote</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy"], "search": "../../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>