
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../model_aggregation/">
      
      
        <link rel="next" href="../model_huggingface/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Model class - Gabarit documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#template_nlp.models_training.model_class" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Gabarit documentation" class="md-header__button md-logo" aria-label="Gabarit documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Gabarit documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Model class
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/OSS-Pole-Emploi/gabarit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OSS-Pole-Emploi/gabarit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Gabarit documentation" class="md-nav__button md-logo" aria-label="Gabarit documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Gabarit documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OSS-Pole-Emploi/gabarit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OSS-Pole-Emploi/gabarit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../frameworks/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Frameworks
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Frameworks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frameworks/NLP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frameworks/NUM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NUM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frameworks/VISION/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VISION
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../frameworks/API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Template api
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Template api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/core/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/core/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/core/logtools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logtools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/core/resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/model/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Model
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_3">
            <span class="md-nav__icon md-icon"></span>
            Model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/model/model_base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/model/model_gabarit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model gabarit
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/routers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Routers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4" id="__nav_3_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4">
            <span class="md-nav__icon md-icon"></span>
            Routers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/technical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_api/routers/schemas/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Schemas
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_4_3" id="__nav_3_1_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_4_3">
            <span class="md-nav__icon md-icon"></span>
            Schemas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/schemas/functional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/schemas/technical/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_api/routers/schemas/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Template nlp
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Template nlp
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models training
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Models training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../model_aggregation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model aggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Model class
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Model class
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class" class="md-nav__link">
    model_class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass" class="md-nav__link">
    ModelClass
  </a>
  
    <nav class="md-nav" aria-label="ModelClass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.display_if_gpu_activated" class="md-nav__link">
    display_if_gpu_activated()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_and_save_metrics" class="md-nav__link">
    get_and_save_metrics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_classes_from_proba" class="md-nav__link">
    get_classes_from_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_metrics_simple_monolabel" class="md-nav__link">
    get_metrics_simple_monolabel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_metrics_simple_multilabel" class="md-nav__link">
    get_metrics_simple_multilabel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_predict_position" class="md-nav__link">
    get_predict_position()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_top_n_from_proba" class="md-nav__link">
    get_top_n_from_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.init_from_standalone_files" class="md-nav__link">
    init_from_standalone_files()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.inverse_transform" class="md-nav__link">
    inverse_transform()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.load_configs" class="md-nav__link">
    load_configs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.load_model" class="md-nav__link">
    load_model()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.predict_proba" class="md-nav__link">
    predict_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.predict_with_proba" class="md-nav__link">
    predict_with_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.reload_from_standalone" class="md-nav__link">
    reload_from_standalone()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../model_huggingface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model huggingface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../utils_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../hf_metrics/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Hf metrics
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2_5" id="__nav_3_2_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_5">
            <span class="md-nav__icon md-icon"></span>
            Hf metrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hf_metrics/accuracy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accuracy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hf_metrics/f1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    F1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hf_metrics/precision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Precision
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hf_metrics/recall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recall
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../models_sklearn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models sklearn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2_6" id="__nav_3_2_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            Models sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model pipeline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_tfidf_gbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf gbt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_tfidf_lgbm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf lgbm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_tfidf_sgdc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf sgdc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_sklearn/model_tfidf_svm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf svm
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../models_tensorflow/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models tensorflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_2_7" id="__nav_3_2_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            Models tensorflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_cnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding cnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_lstm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding lstm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_lstm_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding lstm attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_lstm_gru/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding lstm gru
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_embedding_lstm_structured_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model embedding lstm structured attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/model_tfidf_dense/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model tfidf dense
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../models_tensorflow/utils_deep_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils deep keras
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../monitoring/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/mlflow_logger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mlflow logger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/model_explainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model explainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../preprocessing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../preprocessing/preprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocess
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Template num
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Template num
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models training
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            Models training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/model_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/model_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/model_pipeline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model pipeline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/utils_deep_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils deep keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/utils_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/classifiers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Classifiers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_6" id="__nav_3_3_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_6">
            <span class="md-nav__icon md-icon"></span>
            Classifiers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/model_aggregation_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model aggregation classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/model_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/model_xgboost_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model xgboost classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_6_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/classifiers/models_sklearn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models sklearn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_6_4" id="__nav_3_3_2_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_2_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_6_4">
            <span class="md-nav__icon md-icon"></span>
            Models sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_gbt_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model gbt classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_knn_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model knn classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_lgbm_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model lgbm classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_logistic_regression_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model logistic regression classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_rf_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model rf classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_ridge_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model ridge classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_sgd_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model sgd classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_sklearn/model_svm_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model svm classifier
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_6_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/classifiers/models_tensorflow/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models tensorflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_6_5" id="__nav_3_3_2_6_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_2_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_6_5">
            <span class="md-nav__icon md-icon"></span>
            Models tensorflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/classifiers/models_tensorflow/model_dense_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model dense classifier
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/regressors/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Regressors
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_7" id="__nav_3_3_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_7">
            <span class="md-nav__icon md-icon"></span>
            Regressors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/model_aggregation_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model aggregation regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/model_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/model_xgboost_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model xgboost regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_7_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/regressors/models_sklearn/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models sklearn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_7_4" id="__nav_3_3_2_7_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_2_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_7_4">
            <span class="md-nav__icon md-icon"></span>
            Models sklearn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_bayesian_ridge_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model bayesian ridge regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_elasticnet_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model elasticnet regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_gbt_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model gbt regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_kernel_ridge_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model kernel ridge regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_knn_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model knn regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_lgbm_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model lgbm regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_pls_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model pls regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_rf_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model rf regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_sgd_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model sgd regressor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_sklearn/model_svr_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model svr regressor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2_7_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/models_training/regressors/models_tensorflow/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models tensorflow
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_2_7_5" id="__nav_3_3_2_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_2_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_2_7_5">
            <span class="md-nav__icon md-icon"></span>
            Models tensorflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/models_training/regressors/models_tensorflow/model_dense_regressor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model dense regressor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/monitoring/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/monitoring/mlflow_logger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mlflow logger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/monitoring/model_explainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model explainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_num/preprocessing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_4" id="__nav_3_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_4">
            <span class="md-nav__icon md-icon"></span>
            Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/preprocessing/column_preprocessors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Column preprocessors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/preprocessing/outlier_detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Outlier detection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_num/preprocessing/preprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocess
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Template vision
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Template vision
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/models_training/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Models training
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            Models training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/model_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/model_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/utils_deep_keras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils deep keras
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/utils_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/models_training/classifiers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Classifiers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_2_5" id="__nav_3_4_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_4_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2_5">
            <span class="md-nav__icon md-icon"></span>
            Classifiers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/classifiers/model_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/classifiers/model_cnn_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model cnn classifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/classifiers/model_transfer_learning_classifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model transfer learning classifier
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/models_training/object_detectors/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Object detectors
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_2_6" id="__nav_3_4_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_4_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2_6">
            <span class="md-nav__icon md-icon"></span>
            Object detectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/model_detectron_faster_rcnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model detectron faster rcnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/model_keras_faster_rcnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model keras faster rcnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/model_object_detector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model object detector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/utils_faster_rcnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils faster rcnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/models_training/object_detectors/utils_object_detectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils object detectors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/monitoring/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Monitoring
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_3">
            <span class="md-nav__icon md-icon"></span>
            Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/monitoring/mlflow_logger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mlflow logger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/monitoring/model_explainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model explainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../template_vision/preprocessing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4_4" id="__nav_3_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_4">
            <span class="md-nav__icon md-icon"></span>
            Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/preprocessing/manage_white_borders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage white borders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../template_vision/preprocessing/preprocess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Preprocess
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class" class="md-nav__link">
    model_class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass" class="md-nav__link">
    ModelClass
  </a>
  
    <nav class="md-nav" aria-label="ModelClass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.display_if_gpu_activated" class="md-nav__link">
    display_if_gpu_activated()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_and_save_metrics" class="md-nav__link">
    get_and_save_metrics()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_classes_from_proba" class="md-nav__link">
    get_classes_from_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_metrics_simple_monolabel" class="md-nav__link">
    get_metrics_simple_monolabel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_metrics_simple_multilabel" class="md-nav__link">
    get_metrics_simple_multilabel()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_predict_position" class="md-nav__link">
    get_predict_position()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.get_top_n_from_proba" class="md-nav__link">
    get_top_n_from_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.init_from_standalone_files" class="md-nav__link">
    init_from_standalone_files()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.inverse_transform" class="md-nav__link">
    inverse_transform()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.load_configs" class="md-nav__link">
    load_configs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.load_model" class="md-nav__link">
    load_model()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.predict_proba" class="md-nav__link">
    predict_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.predict_with_proba" class="md-nav__link">
    predict_with_proba()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.reload_from_standalone" class="md-nav__link">
    reload_from_standalone()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template_nlp.models_training.model_class.ModelClass.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Model class</h1>

<div class="doc doc-object doc-module">



<a id="template_nlp.models_training.model_class"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="template_nlp.models_training.model_class.ModelClass" class="doc doc-heading">
          <code>ModelClass</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Parent class for the models</p>

            <details class="quote">
              <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">class</span> <span class="nc">ModelClass</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Parent class for the models&#39;&#39;&#39;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">_default_name</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="c1"># Not implemented :</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="c1"># -&gt; fit (fits a model)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="c1"># -&gt; predict (predict on new content)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># -&gt; predict_proba (predict on new content - returns probas)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="c1"># -&gt; _load_standalone_files (loads standalone files - for a newly created model)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="c1"># Probably need to be overridden, depending on your model :</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="c1"># -&gt; save (specific save instructions)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="c1"># -&gt; _init_new_instance_from_configs (loads model attributes - for a newly created model)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="c1"># -&gt; _hook_post_load_model_pkl (post pkl load function, e.g. load weights from an HDF5 file)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="c1"># -&gt; _is_gpu_activated (specific instruction to know if a gpu is used)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">x_col</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>                 <span class="n">y_col</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">random_seed</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                 <span class="n">level_save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">,</span> <span class="n">multi_label</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Initialization of the parent class.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            model_dir (str): Folder where to save the model</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">                If None, creates a directory based on the model&#39;s name and the date (most common usage)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            model_name (str): The name of the model</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">            x_col (str | int): Name of the columns used for the training - x</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">            y_col (str | int | list if multi-labels): Name of the model&#39;s target column(s) - y</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            random_seed (int): Seed to use for packages randomness</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            level_save (str): Level of saving</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">                LOW: stats + configurations + logger keras - /!\\ The model can&#39;t be reused /!\\ -</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">                MEDIUM: LOW + hdf5 + pkl + plots</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">                HIGH: MEDIUM + predictions</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">            multi_label (bool): If the classification is multi-labels</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            ValueError: If the object level_save is not a valid option ([&#39;LOW&#39;, &#39;MEDIUM&#39;, &#39;HIGH&#39;])</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            NotADirectoryError: If a provided model directory is not a directory (i.e. it&#39;s a file)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="k">if</span> <span class="n">level_save</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;LOW&#39;</span><span class="p">,</span> <span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object level_save (</span><span class="si">{</span><span class="n">level_save</span><span class="si">}</span><span class="s2">) is not a valid option ([&#39;LOW&#39;, &#39;MEDIUM&#39;, &#39;HIGH&#39;])&quot;</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="c1"># Get logger</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="c1"># Model name</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_name</span> <span class="k">if</span> <span class="n">model_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">model_name</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="c1"># Names of the columns used</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x_col</span> <span class="o">=</span> <span class="n">x_col</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_col</span> <span class="o">=</span> <span class="n">y_col</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="c1"># Random seed</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">random_seed</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="c1"># Model folder</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="k">if</span> <span class="n">model_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_new_model_dir</span><span class="p">()</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">model_dir</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">):</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2"> is not a valid directory&quot;</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="c1"># List of classes to consider (set on fit)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="c1"># Multi-labels ?</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">multi_label</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="c1"># Other options</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="o">=</span> <span class="n">level_save</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="c1"># is trained ?</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">trained</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nb_fit</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="c1"># Configuration dict. to be logged. Set on save.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">json_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Trains the model</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            x_train (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">            y_train (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&#39;fit&#39; needs to be overridden&quot;</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">data_agnostic_str_to_list</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Predictions on the test set</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            x_test (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            (np.ndarray): Array, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&#39;predict&#39; needs to be overridden&quot;</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">data_agnostic_str_to_list</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Predicts probabilities on the test dataset</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            x_test (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            (np.ndarray): Array, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&#39;predict_proba&#39; needs to be overridden&quot;</span><span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="k">def</span> <span class="nf">predict_with_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Predicts on the test set with probabilities</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            x_test (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            predicted_class (np.ndarray): The predicted classes, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            predicted_proba (np.ndarray): The predicted probabilities for each class, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="c1"># Process</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">predicted_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">predicted_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_classes_from_proba</span><span class="p">(</span><span class="n">predicted_proba</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="k">return</span> <span class="n">predicted_class</span><span class="p">,</span> <span class="n">predicted_proba</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">def</span> <span class="nf">get_predict_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Gets the order of predictions of y_true.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        Positions start at 1 (not 0)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            x_test (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            y_true (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            ValueError: Not available in multi-labels case</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">            np.ndarray: Array, shape = [n_samples]</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method &#39;get_predict_position&#39;is unavailable in the multi-labels case&quot;</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="c1"># Process</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="c1"># Cast en pd.Series</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="c1"># Get predicted proba</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">predicted_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="c1"># Get position</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">order</span> <span class="o">=</span> <span class="n">predicted_proba</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="n">ranks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span> <span class="o">-</span> <span class="n">order</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">df_probas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">predict_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">df_probas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">cl</span><span class="p">]</span> <span class="k">if</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">df_probas</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_true</span><span class="p">)])</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="k">return</span> <span class="n">predict_positions</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">def</span> <span class="nf">get_classes_from_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicted_proba</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Gets the classes from probabilities</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            predicted_proba (np.ndarray): The probabilities predicted by the model, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            predicted_class (np.ndarray): Shape = [n_samples, n_classes] if multi-labels, shape = [n_samples] otherwise</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">predicted_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span><span class="p">[</span><span class="n">x</span><span class="p">])(</span><span class="n">predicted_proba</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="c1"># If multi-labels, returns a list of 0 and 1</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">predicted_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">predicted_proba</span><span class="p">)</span>  <span class="c1"># 1 if x &gt; 0.5 else 0</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">return</span> <span class="n">predicted_class</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">def</span> <span class="nf">get_top_n_from_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicted_proba</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Gets the Top n predictions from probabilities</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            predicted_proba (np.ndarray): The probabilities predicted by the model, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        kwargs:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            n (int): Number of classes to return</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            ValueError: If the number of classes to return is greater than the number of classes of the model</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            list: top n predictions</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            list: top n probabilities</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="c1"># TODO: Make this method available with multi-labels tasks</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method &#39;get_top_n_from_proba&#39; is unavailable with multi-labels tasks&quot;</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of classes to return is greater than the number of classes of the model&quot;</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="c1"># Process</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">predicted_proba</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="o">-</span><span class="n">n</span><span class="p">:][:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">top_n_proba</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">predicted_proba</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">top_n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span><span class="p">[</span><span class="n">x</span><span class="p">])(</span><span class="n">idx</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="k">return</span> <span class="n">top_n</span><span class="p">,</span> <span class="n">top_n_proba</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">def</span> <span class="nf">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Gets a list of classes from the predictions</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            y (?): Array-like, shape = [n_samples, n_classes], arrays of 0s and 1s</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">                   OR 1D array shape = [n_classes] (only one prediction)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            ValueError: If the size of y does not correspond to the number of classes of the model</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">            List of tuple if multi-labels and several predictions</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            Tuple if multi-labels and one prediction</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            List of classes if mono-label</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="c1"># If multi-label, get classes in tuple</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="c1"># Cast to np array</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">):</span>  <span class="c1"># We consider &quot;-1&quot; in order to take care of the case where y is 1D</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The size of y (</span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) does not correspond&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                                 <span class="sa">f</span><span class="s2">&quot; to the number of classes of the model : (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="c1"># Manage 1D array (only one pred)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="c1"># TODO : shoudln&#39;t we return a list here ?</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="c1"># Several preds</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>                <span class="k">return</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">indicators</span><span class="p">))</span> <span class="k">for</span> <span class="n">indicators</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="c1"># If mono-label, just cast in list if y is np array</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">else</span> <span class="n">y</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="k">def</span> <span class="nf">get_and_save_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series_to_add</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                             <span class="n">type_data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Gets and saves the metrics of a model</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            y_true (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            y_pred (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">            x (?): Input data - Array-like, shape = [n_samples]</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            series_to_add (list&lt;pd.Series&gt;): List of pd.Series to add to the dataframe</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            type_data (str): Type of dataset (validation, test, ...)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            pd.DataFrame: The dataframe containing the statistics</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="c1"># Cast to np.array</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="c1"># Check shapes</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="c1"># Save a predictionn file if wanted</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="o">==</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="c1"># Inverse transform</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="n">y_true_df</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">))</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="n">y_pred_df</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">))</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="c1"># Concat in a dataframe</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;y_true&#39;</span><span class="p">:</span> <span class="n">y_true_df</span><span class="p">,</span> <span class="s1">&#39;y_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_df</span><span class="p">})</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;y_true&#39;</span><span class="p">:</span> <span class="n">y_true_df</span><span class="p">,</span> <span class="s1">&#39;y_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_df</span><span class="p">})</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="c1"># Add a matched column</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;matched&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;y_true&#39;</span><span class="p">,</span> <span class="s1">&#39;y_pred&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">y_true</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">y_pred</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>            <span class="c1"># Add some more columns</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>            <span class="k">if</span> <span class="n">series_to_add</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>                <span class="k">for</span> <span class="n">ser</span> <span class="ow">in</span> <span class="n">series_to_add</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>                    <span class="n">df</span><span class="p">[</span><span class="n">ser</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ser</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="c1"># Reindex</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="c1"># Save predictions</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;predictions</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;matched&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="c1"># Gets global f1 score / acc_tot / trues / falses / precision / recall / support</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="n">f1_weighted</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="n">trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="n">falses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">-</span> <span class="n">trues</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="n">acc_tot</span> <span class="o">=</span> <span class="n">trues</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="n">precision_weighted</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="n">recall_weighted</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>            <span class="n">support</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="n">support</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">support</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">support</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="c1"># We use &#39;weighted&#39; even in the mono-label case since there can be several classes !</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="n">f1_weighted</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="n">trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span> <span class="o">==</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="n">falses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span> <span class="o">!=</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>            <span class="n">acc_tot</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>            <span class="n">precision_weighted</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="n">recall_weighted</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>            <span class="n">labels_tmp</span><span class="p">,</span> <span class="n">counts_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>            <span class="n">support</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>                <span class="k">if</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">labels_tmp</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>                    <span class="n">idx_tmp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels_tmp</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                    <span class="n">support</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_tmp</span><span class="p">[</span><span class="n">idx_tmp</span><span class="p">]</span> <span class="o">/</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="c1"># Global Statistics</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;-- * * * * * * * * * * * * * * --&#39;</span><span class="p">)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Statistics f1-score</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total accuracy : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">acc_tot</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">% </span><span class="se">\t</span><span class="s2"> Trues: </span><span class="si">{</span><span class="n">trues</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Falses: </span><span class="si">{</span><span class="n">falses</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-score (weighted) : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">f1_weighted</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision (weighted) : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">precision_weighted</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall (weighted) : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">recall_weighted</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="c1"># Metrics file</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">dict_df_stats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="c1"># Add metrics depending on mono/multi labels &amp; manage confusion matrices</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">log_stats</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>            <span class="c1"># Details per category</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>            <span class="n">mcm</span> <span class="o">=</span> <span class="n">multilabel_confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>                <span class="n">c_mat</span> <span class="o">=</span> <span class="n">mcm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>                <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_info_from_c_mat</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">log_info</span><span class="o">=</span><span class="n">log_stats</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>                <span class="c1"># Plot individual confusion matrix if level_save &gt; LOW</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                    <span class="n">none_class</span> <span class="o">=</span> <span class="s1">&#39;not_&#39;</span> <span class="o">+</span> <span class="n">label</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                    <span class="n">tmp_label</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;,|:|\s&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_confusion_matrix</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="p">[</span><span class="n">none_class</span><span class="p">,</span> <span class="n">label</span><span class="p">],</span> <span class="n">type_data</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tmp_label</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">type_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                                                <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subdir</span><span class="o">=</span><span class="n">type_data</span><span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_confusion_matrix</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="p">[</span><span class="n">none_class</span><span class="p">,</span> <span class="n">label</span><span class="p">],</span> <span class="n">type_data</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tmp_label</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">type_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>                                                <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subdir</span><span class="o">=</span><span class="n">type_data</span><span class="p">)</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>            <span class="c1"># Plot confusion matrices if level_save &gt; LOW</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                        <span class="sa">f</span><span class="s2">&quot;Warning, there are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="si">}</span><span class="s2"> categories to plot in the confusion matrix.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                        <span class="s2">&quot;Heavy chances of slowness/display bugs/crashes...</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                        <span class="s2">&quot;SKIP the plots&quot;</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>                    <span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                    <span class="c1"># Global stats</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                    <span class="n">c_mat</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_confusion_matrix</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">type_data</span><span class="o">=</span><span class="n">type_data</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_plot_confusion_matrix</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">type_data</span><span class="o">=</span><span class="n">type_data</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="c1"># Get stats per class</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>                <span class="n">label_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># Fix : If label is an int, can cause some problems (e.g. only zeroes in the confusion matrix)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="n">none_class</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="k">if</span> <span class="n">label_str</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span> <span class="k">else</span> <span class="s1">&#39;others&#39;</span>  <span class="c1"># Check that the class is not already &#39;None&#39;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                <span class="n">y_true_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_str</span> <span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">none_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">y_true</span><span class="p">]</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                <span class="n">y_pred_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_str</span> <span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">none_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="p">]</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="n">c_mat_tmp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true_tmp</span><span class="p">,</span> <span class="n">y_pred_tmp</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">none_class</span><span class="p">,</span> <span class="n">label_str</span><span class="p">])</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>                <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_info_from_c_mat</span><span class="p">(</span><span class="n">c_mat_tmp</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">log_info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="c1"># Add global statistics</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="n">f1_weighted</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">acc_tot</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision_weighted</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall_weighted</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="s1">&#39;Trues&#39;</span><span class="p">:</span> <span class="n">trues</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="s1">&#39;Falses&#39;</span><span class="p">:</span> <span class="n">falses</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="s1">&#39;True positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="s1">&#39;True negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="s1">&#39;False positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="s1">&#39;False negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="s1">&#39;Condition positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="s1">&#39;Condition negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="s1">&#39;Predicted positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="s1">&#39;Predicted negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="p">}</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="n">df_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_df_stats</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="c1"># Add support</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="n">df_stats</span><span class="p">[</span><span class="s1">&#39;Support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="c1"># Save .csv</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;f1</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">f1_weighted</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">df_stats</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="c1"># Save accuracy</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">acc_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;acc</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">acc_tot</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">acc_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">):</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="k">pass</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="k">return</span> <span class="n">df_stats</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="k">def</span> <span class="nf">get_metrics_simple_monolabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Gets metrics on mono-label predictions</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        Same as the method get_and_save_metrics but without all the fluff (save, etc.)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            y_true (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">            y_pred (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            ValueError: If not in mono-label mode</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">            pd.DataFrame: The dataframe containing statistics</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method get_metrics_simple_monolabel only works for the mono-label case&quot;</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="c1"># Cast to np.array</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="c1"># Check shapes</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="c1"># Gets global f1 score / acc_tot / trues / falses / precision / recall / support</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="n">f1_weighted</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span> <span class="o">==</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">falses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span> <span class="o">!=</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="n">acc_tot</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">precision_weighted</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">recall_weighted</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="n">labels_tmp</span><span class="p">,</span> <span class="n">counts_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="n">support</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">):</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="k">if</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">labels_tmp</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                <span class="n">idx_tmp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels_tmp</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>                <span class="n">support</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_tmp</span><span class="p">[</span><span class="n">idx_tmp</span><span class="p">]</span> <span class="o">/</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="c1"># DataFrame metrics</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">dict_df_stats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="c1"># Get stats per class</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>            <span class="n">label_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># Fix : If label is an int, can cause some problems (e.g. only zeroes in the confusion matrix)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="n">none_class</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="k">if</span> <span class="n">label_str</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span> <span class="k">else</span> <span class="s1">&#39;others&#39;</span>  <span class="c1"># Check that the class is not already &#39;None&#39;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="n">y_true_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_str</span> <span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">none_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">y_true</span><span class="p">]</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="n">y_pred_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_str</span> <span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">none_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="p">]</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="n">c_mat_tmp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true_tmp</span><span class="p">,</span> <span class="n">y_pred_tmp</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">none_class</span><span class="p">,</span> <span class="n">label_str</span><span class="p">])</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_info_from_c_mat</span><span class="p">(</span><span class="n">c_mat_tmp</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">log_info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="c1"># Add global statistics</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="n">f1_weighted</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">acc_tot</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision_weighted</span><span class="p">,</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall_weighted</span><span class="p">,</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="s1">&#39;Trues&#39;</span><span class="p">:</span> <span class="n">trues</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="s1">&#39;Falses&#39;</span><span class="p">:</span> <span class="n">falses</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="s1">&#39;True positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="s1">&#39;True negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="s1">&#39;False positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>            <span class="s1">&#39;False negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="s1">&#39;Condition positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="s1">&#39;Condition negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="s1">&#39;Predicted positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="s1">&#39;Predicted negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="p">}</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">df_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_df_stats</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="c1"># Add support</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="n">df_stats</span><span class="p">[</span><span class="s1">&#39;Support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="c1"># Return dataframe</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="k">return</span> <span class="n">df_stats</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="k">def</span> <span class="nf">get_metrics_simple_multilabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Gets metrics on multi-label predictions</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        Same as the method get_and_save_metrics but without all the fluff (save, etc.)</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            y_true (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">            y_pred (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">            ValueError: If not with multi-labels tasks</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">            pd.DataFrame: The dataframe containing statistics</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method get_metrics_simple_multilabel only works for multi-labels cases&quot;</span><span class="p">)</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="c1"># Cast to np.array</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="c1"># Gets global f1 score / acc_tot / trues / falses / precision / recall / support</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>        <span class="n">f1_weighted</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="n">trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="n">falses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">-</span> <span class="n">trues</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="n">acc_tot</span> <span class="o">=</span> <span class="n">trues</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>        <span class="n">precision_weighted</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="n">recall_weighted</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="n">support</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="n">support</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">support</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">support</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="c1"># DataFrame metrics</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="n">dict_df_stats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="c1"># Add metrics</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="c1"># Details per category</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="n">mcm</span> <span class="o">=</span> <span class="n">multilabel_confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="n">c_mat</span> <span class="o">=</span> <span class="n">mcm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_info_from_c_mat</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">log_info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="c1"># Add global statistics</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="n">f1_weighted</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">acc_tot</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>            <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision_weighted</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>            <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall_weighted</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>            <span class="s1">&#39;Trues&#39;</span><span class="p">:</span> <span class="n">trues</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>            <span class="s1">&#39;Falses&#39;</span><span class="p">:</span> <span class="n">falses</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>            <span class="s1">&#39;True positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>            <span class="s1">&#39;True negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="s1">&#39;False positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="s1">&#39;False negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="s1">&#39;Condition positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>            <span class="s1">&#39;Condition negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>            <span class="s1">&#39;Predicted positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>            <span class="s1">&#39;Predicted negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="p">}</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="n">df_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_df_stats</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="c1"># Add support</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="n">df_stats</span><span class="p">[</span><span class="s1">&#39;Support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="c1"># Return dataframe</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="k">return</span> <span class="n">df_stats</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">def</span> <span class="nf">_update_info_from_c_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c_mat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">log_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Updates a dataframe for the method get_and_save_metrics, given a confusion matrix</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">            c_mat (np.ndarray): Confusion matrix</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">            label (str): Label to use</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">            log_info (bool): If the statistics must be logged</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">            dict: Dictionary with the information for the update of the dataframe</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="c1"># Extract all needed info from c_mat</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="n">true_negative</span> <span class="o">=</span> <span class="n">c_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="n">true_positive</span> <span class="o">=</span> <span class="n">c_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="n">false_negative</span> <span class="o">=</span> <span class="n">c_mat</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="n">false_positive</span> <span class="o">=</span> <span class="n">c_mat</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>        <span class="n">condition_positive</span> <span class="o">=</span> <span class="n">false_negative</span> <span class="o">+</span> <span class="n">true_positive</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">condition_negative</span> <span class="o">=</span> <span class="n">false_positive</span> <span class="o">+</span> <span class="n">true_negative</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">predicted_positive</span> <span class="o">=</span> <span class="n">false_positive</span> <span class="o">+</span> <span class="n">true_positive</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="n">predicted_negative</span> <span class="o">=</span> <span class="n">false_negative</span> <span class="o">+</span> <span class="n">true_negative</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="n">trues_cat</span> <span class="o">=</span> <span class="n">true_negative</span> <span class="o">+</span> <span class="n">true_positive</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="n">falses_cat</span> <span class="o">=</span> <span class="n">false_negative</span> <span class="o">+</span> <span class="n">false_positive</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="n">accuracy</span> <span class="o">=</span> <span class="p">(</span><span class="n">true_negative</span> <span class="o">+</span> <span class="n">true_positive</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_negative</span> <span class="o">+</span> <span class="n">true_positive</span> <span class="o">+</span> <span class="n">false_negative</span> <span class="o">+</span> <span class="n">false_positive</span><span class="p">)</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="n">precision</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">predicted_positive</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">true_positive</span> <span class="o">/</span> <span class="n">predicted_positive</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">recall</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">condition_positive</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">true_positive</span> <span class="o">/</span> <span class="n">condition_positive</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="n">f1</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">precision</span> <span class="o">*</span> <span class="n">recall</span> <span class="o">/</span> <span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">)</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="c1"># Display some info</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="k">if</span> <span class="n">log_info</span><span class="p">:</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                <span class="sa">f</span><span class="s2">&quot;F1-score: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">  </span><span class="se">\t</span><span class="s2"> Precision: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">precision</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">% </span><span class="se">\t</span><span class="s2">&quot;</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>                <span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">recall</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">% </span><span class="se">\t</span><span class="s2"> Trues: </span><span class="si">{</span><span class="n">trues_cat</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Falses: </span><span class="si">{</span><span class="n">falses_cat</span><span class="si">}</span><span class="s2"> </span><span class="se">\t\t</span><span class="s2"> --- </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="p">)</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="c1"># Return result</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>            <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>            <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>            <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision</span><span class="p">,</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall</span><span class="p">,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="s1">&#39;Trues&#39;</span><span class="p">:</span> <span class="n">trues_cat</span><span class="p">,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>            <span class="s1">&#39;Falses&#39;</span><span class="p">:</span> <span class="n">falses_cat</span><span class="p">,</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="s1">&#39;True positive&#39;</span><span class="p">:</span> <span class="n">true_positive</span><span class="p">,</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>            <span class="s1">&#39;True negative&#39;</span><span class="p">:</span> <span class="n">true_negative</span><span class="p">,</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>            <span class="s1">&#39;False positive&#39;</span><span class="p">:</span> <span class="n">false_positive</span><span class="p">,</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>            <span class="s1">&#39;False negative&#39;</span><span class="p">:</span> <span class="n">false_negative</span><span class="p">,</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>            <span class="s1">&#39;Condition positive&#39;</span><span class="p">:</span> <span class="n">condition_positive</span><span class="p">,</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="s1">&#39;Condition negative&#39;</span><span class="p">:</span> <span class="n">condition_negative</span><span class="p">,</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>            <span class="s1">&#39;Predicted positive&#39;</span><span class="p">:</span> <span class="n">predicted_positive</span><span class="p">,</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>            <span class="s1">&#39;Predicted negative&#39;</span><span class="p">:</span> <span class="n">predicted_negative</span><span class="p">,</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="p">}</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>    <span class="k">def</span> <span class="nf">_plot_confusion_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c_mat</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">type_data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                               <span class="n">normalized</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">subdir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Plots a confusion matrix</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">            c_mat (np.ndarray): Confusion matrix</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">            labels (list): Labels to plot</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="sd">            type_data (str): Type of dataset (validation, test, ...)</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="sd">            normalized (bool): If the confusion matrix should be normalized</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a><span class="sd">            subdir (str): Sub-directory for writing the plot</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>        <span class="c1"># Get title</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>        <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>            <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Normalized confusion matrix</span><span class="si">{</span><span class="s1">&#39; - &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>            <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Confusion matrix, without normalization</span><span class="si">{</span><span class="s1">&#39; - &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="c1"># Init. plot</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="n">width</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_mat</span><span class="p">))</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="n">height</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="c1"># Plot</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>            <span class="n">c_mat</span> <span class="o">=</span> <span class="n">c_mat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">c_mat</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>            <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span> <span class="c1"># type: ignore</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>            <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span> <span class="c1"># type: ignore</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="c1"># labels, title and ticks</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted classes&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">height</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Real classes&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">height</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">width</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="c1"># Save</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">plots_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s1">&#39;plots&#39;</span><span class="p">)</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="k">if</span> <span class="n">subdir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Ajout subdir</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>            <span class="n">plots_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">plots_path</span><span class="p">,</span> <span class="n">subdir</span><span class="p">)</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">type_data</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">confusion_matrix</span><span class="si">{</span><span class="s1">&#39;_normalized&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">normalized</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">.png&quot;</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plots_path</span><span class="p">):</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">plots_path</span><span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">plots_path</span><span class="p">,</span> <span class="n">file_name</span><span class="p">))</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="c1"># Close figures</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">def</span> <span class="nf">_get_new_model_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Gets a folder where to save the model</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a><span class="sd">            str: Path to the folder</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>        <span class="n">models_dir</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_models_path</span><span class="p">()</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="n">subfolder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">models_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="p">)</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">folder_name</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">_%Y_%m_%d-%H_%M_%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="n">model_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subfolder</span><span class="p">,</span> <span class="n">folder_name</span><span class="p">)</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">):</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Wait 1 second so that the &#39;date&#39; changes...</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_new_model_dir</span><span class="p">()</span>  <span class="c1"># Get new directory name</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="k">return</span> <span class="n">model_dir</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Saves the model</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">            json_data (dict): Additional configurations to be saved</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="c1"># Manage paths</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>        <span class="n">pkl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>        <span class="n">conf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s2">&quot;configurations.json&quot;</span><span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="c1"># Save the model if level_save &gt; &#39;LOW&#39;</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pkl_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="c1"># Save configuration JSON</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>            <span class="s1">&#39;maintainers&#39;</span><span class="p">:</span> <span class="s1">&#39;Agence DataServices&#39;</span><span class="p">,</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>            <span class="s1">&#39;gabarit_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.3.4.dev0+local&#39;</span><span class="p">,</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>            <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y - %H:%M:%S&quot;</span><span class="p">),</span>  <span class="c1"># Not the same as the folder&#39;s name</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_package_version</span><span class="p">(),</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="s1">&#39;model_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="s1">&#39;model_dir&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="s1">&#39;trained&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="s1">&#39;nb_fit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_fit</span><span class="p">,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="s1">&#39;list_classes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">,</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="s1">&#39;dict_classes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="s1">&#39;x_col&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_col</span><span class="p">,</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>            <span class="s1">&#39;y_col&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_col</span><span class="p">,</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="p">,</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="s1">&#39;multi_label&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">,</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="s1">&#39;level_save&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span><span class="p">,</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>            <span class="s1">&#39;librairie&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>        <span class="p">}</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>        <span class="c1"># Merge json_data if not None</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>        <span class="k">if</span> <span class="n">json_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="c1"># Priority given to json_data !</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">json_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">json_data</span><span class="p">}</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>        <span class="c1"># Add conf to attributes</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">json_dict</span> <span class="o">=</span> <span class="n">json_dict</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>        <span class="c1"># Save conf</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">conf_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json_dict</span><span class="p">,</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">NpEncoder</span><span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>        <span class="c1"># Now, save a properties file for the model upload</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_upload_properties</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>    <span class="k">def</span> <span class="nf">_save_upload_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Prepares a configuration file for a future export (e.g on an artifactory)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">            json_dict: Configurations to save</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="k">if</span> <span class="n">json_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>            <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="c1"># Manage paths</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>        <span class="n">properties_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s2">&quot;properties.json&quot;</span><span class="p">)</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="n">vanilla_model_upload_instructions</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_ressources_path</span><span class="p">(),</span> <span class="s1">&#39;model_upload_instructions.md&#39;</span><span class="p">)</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="n">specific_model_upload_instructions</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s2">&quot;model_upload_instructions.md&quot;</span><span class="p">)</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>        <span class="c1"># First, we define a list of &quot;allowed&quot; properties</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>        <span class="n">allowed_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;maintainers&quot;</span><span class="p">,</span> <span class="s2">&quot;gabarit_version&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;package_version&quot;</span><span class="p">,</span> <span class="s2">&quot;model_name&quot;</span><span class="p">,</span> <span class="s2">&quot;list_classes&quot;</span><span class="p">,</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                              <span class="s2">&quot;librairie&quot;</span><span class="p">,</span> <span class="s2">&quot;fit_time&quot;</span><span class="p">]</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>        <span class="c1"># Now we filter these properties</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>        <span class="n">final_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">json_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">allowed_properties</span><span class="p">}</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>        <span class="c1"># Save</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">properties_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">final_dict</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">NpEncoder</span><span class="p">)</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>        <span class="c1"># Add instructions to upload a model to a storage solution (e.g. Artifactory)</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">vanilla_model_upload_instructions</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>            <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="c1"># TODO: to be improved</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>        <span class="n">new_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;model_dir_path_identifier&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">))</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">specific_model_upload_instructions</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_content</span><span class="p">)</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="k">def</span> <span class="nf">load_model</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Loads a model from a path or a model name</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">            model_dir (str): Absolute path of the folder containing the model to load</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">            config_path (str): Absolute path to a configuration file. Backup on the model_dir defaults configuration file.</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">                               Most of the time, you should leave this empty.</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">            ModelClass: The loaded model</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">            dict: The model configuration</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="c1"># First load the model configurations</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>        <span class="n">configs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_configs</span><span class="p">(</span><span class="n">model_dir</span><span class="o">=</span><span class="n">model_dir</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">)</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="c1"># Load the model object from a pickle file</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="n">pkl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">configs</span><span class="p">[</span><span class="s1">&#39;model_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pkl_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>            <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>        <span class="c1"># Change model_dir to the input model_dir (usually when the model has been trained on another computer)</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>        <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;model_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_dir</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>        <span class="n">model</span><span class="o">.</span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">model_dir</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="c1"># Post load specificities</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="n">model</span><span class="o">.</span><span class="n">_hook_post_load_model_pkl</span><span class="p">()</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>        <span class="c1"># Display if GPU is being used</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>        <span class="n">model</span><span class="o">.</span><span class="n">display_if_gpu_activated</span><span class="p">()</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>        <span class="c1"># Return model</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">configs</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>    <span class="k">def</span> <span class="nf">load_configs</span><span class="p">(</span><span class="n">model_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Loads a model&#39;s configuration file as a dictionary</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">            model_dir (str): Absolute path of the model.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">                             Can be None to load a configuration path as it is, but config_path can&#39;t also be None.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">            config_path (str): Absolute path to a configuration file. Backup on the model_dir defaults configuration file.</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">                               Most of the time, you should leave this empty.</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">            ValueError: If both model_dir and config_path are None.</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">            dict: A model&#39;s configurations</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>        <span class="c1"># Manage errors</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>        <span class="k">if</span> <span class="n">model_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;model_dir and config_path can&#39;t both be None in load_configs function&quot;</span><span class="p">)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="c1"># Get configurations</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>        <span class="n">configuration_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_dir</span><span class="p">,</span> <span class="s1">&#39;configurations.json&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">config_path</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">configuration_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>            <span class="n">configs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>        <span class="c1"># Can&#39;t set int as keys in json, so need to cast it after reloading</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="c1"># dict_classes keys are always ints</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>        <span class="k">if</span> <span class="s1">&#39;dict_classes&#39;</span> <span class="ow">in</span> <span class="n">configs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;dict_classes&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>            <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;dict_classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="n">col</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;dict_classes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="k">elif</span> <span class="s1">&#39;list_classes&#39;</span> <span class="ow">in</span> <span class="n">configs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;list_classes&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>            <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;dict_classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">col</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s1">&#39;list_classes&#39;</span><span class="p">])}</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="c1"># Return configs</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>        <span class="k">return</span> <span class="n">configs</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>    <span class="k">def</span> <span class="nf">_hook_post_load_model_pkl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Manages a model specificities post load from a pickle file (i.e. not from standalone files)&#39;&#39;&#39;</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>        <span class="k">pass</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>    <span class="k">def</span> <span class="nf">init_from_standalone_files</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Init. a new model from a config file and standalone files.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">        The main purpose of this function is to be able to use an old model trained with an old version which is not</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">        unpicklable anymore.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">        We should be able to recreate a new class object as this library tries to save all infos in a configuration file,</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">        and all models / tokenizers / etc. in standalone files.</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">        The standalone files will be inferred from the model_dir argument, except if specific **kwargs are provided.</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">        To see which kwargs are available for your model, checks it&#39;s own `_load_standalone_files` function.</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">        Of course, the function will raise an error if `model_dir` is None and no **kwargs arguments are provided.</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">        WARNING : It will create a new folder for the reloaded model and copy many files in this new folder.</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">                  That may take some space in your hard disk.</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">        WARNING : This function should be called with the class of the model to be reloaded.</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">                  e.g. ModelEmbeddingLstm.init_from_standalone_files(...)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">            model_dir (str): Absolute path of the folder containing the model to load.</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">                             If None, config_path must be set.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">            config_path (str): Absolute path to a configuration file.</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">                               If None, backups on the model_dir defaults configuration file.</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">                               If None, model_dir must be set.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">            ValueError: If both model_dir and config_path are None.</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">            ModelClass: The loaded model</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">            dict: The model configuration</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>        <span class="k">if</span> <span class="n">model_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either model_dir or config_path must be set&quot;</span><span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>        <span class="c1"># First load the model configurations</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>        <span class="n">configs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_configs</span><span class="p">(</span><span class="n">model_dir</span><span class="o">=</span><span class="n">model_dir</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>        <span class="c1"># Init model from configurations</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>        <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_init_new_instance_from_configs</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>        <span class="c1"># Load standalone files</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>        <span class="n">model</span><span class="o">.</span><span class="n">_load_standalone_files</span><span class="p">(</span><span class="n">default_model_dir</span><span class="o">=</span><span class="n">model_dir</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="c1"># Set configs to new model dir</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;model_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model_dir</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="c1"># Return model</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">configs</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="k">def</span> <span class="nf">_init_new_instance_from_configs</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">configs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Inits a new instance from a set of configurations</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">            configs: a set of configurations of a model to be reloaded</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">            ModelClass: the newly generated class</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>        <span class="c1"># Create class</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>        <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>        <span class="c1"># Set class attributes from config</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>        <span class="c1"># model.model_name = # Keep the created name</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>        <span class="c1"># model.model_dir = # Keep the created folder</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>        <span class="n">model</span><span class="o">.</span><span class="n">nb_fit</span> <span class="o">=</span> <span class="n">configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nb_fit&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Consider one unique fit by default</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>        <span class="n">model</span><span class="o">.</span><span class="n">trained</span> <span class="o">=</span> <span class="n">configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trained&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># Consider trained by default</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>        <span class="c1"># Try to read the following attributes from configs and, if absent, keep the current one</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>        <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;x_col&#39;</span><span class="p">,</span> <span class="s1">&#39;y_col&#39;</span><span class="p">,</span> <span class="s1">&#39;list_classes&#39;</span><span class="p">,</span> <span class="s1">&#39;dict_classes&#39;</span><span class="p">,</span> <span class="s1">&#39;multi_label&#39;</span><span class="p">,</span> <span class="s1">&#39;level_save&#39;</span><span class="p">,</span> <span class="s1">&#39;random_seed&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>            <span class="nb">setattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">configs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)))</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>        <span class="c1"># Return the new model</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>        <span class="k">return</span> <span class="n">model</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>    <span class="k">def</span> <span class="nf">_load_standalone_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default_model_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Loads standalone files for a newly created model via _init_new_instance_from_configs</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        Kwargs:</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            default_model_dir (str): a path to look for default file paths</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">                                     If None, standalone files path should all be provided</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&#39;_load_standalone_files&#39; needs to be overridden&quot;</span><span class="p">)</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>    <span class="nd">@classmethod</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>    <span class="k">def</span> <span class="nf">reload_from_standalone</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Deprecated&#39;&#39;&#39;</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DEPRECATED : use load_model class method instead&quot;</span><span class="p">)</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>    <span class="k">def</span> <span class="nf">display_if_gpu_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Displays if a GPU is being used&#39;&#39;&#39;</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_gpu_activated</span><span class="p">():</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GPU activated&quot;</span><span class="p">)</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>    <span class="k">def</span> <span class="nf">_is_gpu_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;Checks if we use a GPU</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">            bool: whether GPU is available or not</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a><span class="sd">        &#39;&#39;&#39;</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="c1"># By default, no GPU</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level_save</span><span class="o">=</span><span class="s1">&#39;HIGH&#39;</span><span class="p">,</span> <span class="n">multi_label</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialization of the parent class.</p>

<details class="kwargs" open>
  <summary>Kwargs</summary>
  <p>model_dir (str): Folder where to save the model
    If None, creates a directory based on the model's name and the date (most common usage)
model_name (str): The name of the model
x_col (str | int): Name of the columns used for the training - x
y_col (str | int | list if multi-labels): Name of the model's target column(s) - y
random_seed (int): Seed to use for packages randomness
level_save (str): Level of saving
    LOW: stats + configurations + logger keras - /! The model can't be reused /! -
    MEDIUM: LOW + hdf5 + pkl + plots
    HIGH: MEDIUM + predictions
multi_label (bool): If the classification is multi-labels</p>
</details>      <p>Raises:
    ValueError: If the object level_save is not a valid option (['LOW', 'MEDIUM', 'HIGH'])
    NotADirectoryError: If a provided model directory is not a directory (i.e. it's a file)</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">x_col</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>             <span class="n">y_col</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">random_seed</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>             <span class="n">level_save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">,</span> <span class="n">multi_label</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Initialization of the parent class.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        model_dir (str): Folder where to save the model</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            If None, creates a directory based on the model&#39;s name and the date (most common usage)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        model_name (str): The name of the model</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        x_col (str | int): Name of the columns used for the training - x</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        y_col (str | int | list if multi-labels): Name of the model&#39;s target column(s) - y</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        random_seed (int): Seed to use for packages randomness</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        level_save (str): Level of saving</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">            LOW: stats + configurations + logger keras - /!\\ The model can&#39;t be reused /!\\ -</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            MEDIUM: LOW + hdf5 + pkl + plots</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">            HIGH: MEDIUM + predictions</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        multi_label (bool): If the classification is multi-labels</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        ValueError: If the object level_save is not a valid option ([&#39;LOW&#39;, &#39;MEDIUM&#39;, &#39;HIGH&#39;])</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        NotADirectoryError: If a provided model directory is not a directory (i.e. it&#39;s a file)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">if</span> <span class="n">level_save</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;LOW&#39;</span><span class="p">,</span> <span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The object level_save (</span><span class="si">{</span><span class="n">level_save</span><span class="si">}</span><span class="s2">) is not a valid option ([&#39;LOW&#39;, &#39;MEDIUM&#39;, &#39;HIGH&#39;])&quot;</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="c1"># Get logger</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="c1"># Model name</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_name</span> <span class="k">if</span> <span class="n">model_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">model_name</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="c1"># Names of the columns used</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">x_col</span> <span class="o">=</span> <span class="n">x_col</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">y_col</span> <span class="o">=</span> <span class="n">y_col</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="c1"># Random seed</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">random_seed</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="c1"># Model folder</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">if</span> <span class="n">model_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_new_model_dir</span><span class="p">()</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">model_dir</span><span class="p">):</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">):</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2"> is not a valid directory&quot;</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="c1"># List of classes to consider (set on fit)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="c1"># Multi-labels ?</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">multi_label</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="c1"># Other options</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="o">=</span> <span class="n">level_save</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="c1"># is trained ?</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">trained</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">nb_fit</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="c1"># Configuration dict. to be logged. Set on save.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">json_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.display_if_gpu_activated" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">display_if_gpu_activated</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Displays if a GPU is being used</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="k">def</span> <span class="nf">display_if_gpu_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Displays if a GPU is being used&#39;&#39;&#39;</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_gpu_activated</span><span class="p">():</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GPU activated&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.fit" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Trains the model</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_train</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like or sparse matrix, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_train</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Trains the model</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        x_train (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        y_train (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&#39;fit&#39; needs to be overridden&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.get_and_save_metrics" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_and_save_metrics</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series_to_add</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_data</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets and saves the metrics of a model</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y_true</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_pred</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Kwargs:
    x (?): Input data - Array-like, shape = [n_samples]
    series_to_add (list<pd.Series>): List of pd.Series to add to the dataframe
    type_data (str): Type of dataset (validation, test, ...)
Returns:
    pd.DataFrame: The dataframe containing the statistics</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="k">def</span> <span class="nf">get_and_save_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">series_to_add</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                         <span class="n">type_data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gets and saves the metrics of a model</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        y_true (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        y_pred (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        x (?): Input data - Array-like, shape = [n_samples]</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        series_to_add (list&lt;pd.Series&gt;): List of pd.Series to add to the dataframe</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        type_data (str): Type of dataset (validation, test, ...)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        pd.DataFrame: The dataframe containing the statistics</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="c1"># Cast to np.array</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="c1"># Check shapes</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="c1"># Save a predictionn file if wanted</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="o">==</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="c1"># Inverse transform</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="n">y_true_df</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">))</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">y_pred_df</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">))</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="c1"># Concat in a dataframe</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;y_true&#39;</span><span class="p">:</span> <span class="n">y_true_df</span><span class="p">,</span> <span class="s1">&#39;y_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_df</span><span class="p">})</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;y_true&#39;</span><span class="p">:</span> <span class="n">y_true_df</span><span class="p">,</span> <span class="s1">&#39;y_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_df</span><span class="p">})</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="c1"># Add a matched column</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;matched&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;y_true&#39;</span><span class="p">,</span> <span class="s1">&#39;y_pred&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">y_true</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">y_pred</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="c1"># Add some more columns</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="k">if</span> <span class="n">series_to_add</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>            <span class="k">for</span> <span class="n">ser</span> <span class="ow">in</span> <span class="n">series_to_add</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>                <span class="n">df</span><span class="p">[</span><span class="n">ser</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ser</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>  <span class="c1"># Reindex</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="c1"># Save predictions</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;predictions</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;matched&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="c1"># Gets global f1 score / acc_tot / trues / falses / precision / recall / support</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="n">f1_weighted</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="n">trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="n">falses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">-</span> <span class="n">trues</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="n">acc_tot</span> <span class="o">=</span> <span class="n">trues</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="n">precision_weighted</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="n">recall_weighted</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">support</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="n">support</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">support</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">support</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="c1"># We use &#39;weighted&#39; even in the mono-label case since there can be several classes !</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">f1_weighted</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="n">trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span> <span class="o">==</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">falses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span> <span class="o">!=</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>        <span class="n">acc_tot</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="n">precision_weighted</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="n">recall_weighted</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">labels_tmp</span><span class="p">,</span> <span class="n">counts_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="n">support</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>            <span class="k">if</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">labels_tmp</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>                <span class="n">idx_tmp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels_tmp</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>                <span class="n">support</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_tmp</span><span class="p">[</span><span class="n">idx_tmp</span><span class="p">]</span> <span class="o">/</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="c1"># Global Statistics</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;-- * * * * * * * * * * * * * * --&#39;</span><span class="p">)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Statistics f1-score</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total accuracy : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">acc_tot</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">% </span><span class="se">\t</span><span class="s2"> Trues: </span><span class="si">{</span><span class="n">trues</span><span class="si">}</span><span class="s2"> </span><span class="se">\t</span><span class="s2"> Falses: </span><span class="si">{</span><span class="n">falses</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-score (weighted) : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">f1_weighted</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision (weighted) : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">precision_weighted</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall (weighted) : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">recall_weighted</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;--------------------------------&#39;</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="c1"># Metrics file</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">dict_df_stats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="c1"># Add metrics depending on mono/multi labels &amp; manage confusion matrices</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">log_stats</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="c1"># Details per category</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="n">mcm</span> <span class="o">=</span> <span class="n">multilabel_confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>            <span class="n">c_mat</span> <span class="o">=</span> <span class="n">mcm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>            <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_info_from_c_mat</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">log_info</span><span class="o">=</span><span class="n">log_stats</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="c1"># Plot individual confusion matrix if level_save &gt; LOW</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                <span class="n">none_class</span> <span class="o">=</span> <span class="s1">&#39;not_&#39;</span> <span class="o">+</span> <span class="n">label</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="n">tmp_label</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;,|:|\s&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_plot_confusion_matrix</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="p">[</span><span class="n">none_class</span><span class="p">,</span> <span class="n">label</span><span class="p">],</span> <span class="n">type_data</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tmp_label</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">type_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                                            <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subdir</span><span class="o">=</span><span class="n">type_data</span><span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_plot_confusion_matrix</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="p">[</span><span class="n">none_class</span><span class="p">,</span> <span class="n">label</span><span class="p">],</span> <span class="n">type_data</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tmp_label</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">type_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>                                            <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subdir</span><span class="o">=</span><span class="n">type_data</span><span class="p">)</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="c1"># Plot confusion matrices if level_save &gt; LOW</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                    <span class="sa">f</span><span class="s2">&quot;Warning, there are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="si">}</span><span class="s2"> categories to plot in the confusion matrix.</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                    <span class="s2">&quot;Heavy chances of slowness/display bugs/crashes...</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                    <span class="s2">&quot;SKIP the plots&quot;</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>                <span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>                <span class="c1"># Global stats</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="n">c_mat</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_plot_confusion_matrix</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">type_data</span><span class="o">=</span><span class="n">type_data</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_plot_confusion_matrix</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">type_data</span><span class="o">=</span><span class="n">type_data</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="c1"># Get stats per class</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="n">label_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># Fix : If label is an int, can cause some problems (e.g. only zeroes in the confusion matrix)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="n">none_class</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="k">if</span> <span class="n">label_str</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span> <span class="k">else</span> <span class="s1">&#39;others&#39;</span>  <span class="c1"># Check that the class is not already &#39;None&#39;</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">y_true_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_str</span> <span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">none_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">y_true</span><span class="p">]</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="n">y_pred_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_str</span> <span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">none_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="p">]</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>            <span class="n">c_mat_tmp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true_tmp</span><span class="p">,</span> <span class="n">y_pred_tmp</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">none_class</span><span class="p">,</span> <span class="n">label_str</span><span class="p">])</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_info_from_c_mat</span><span class="p">(</span><span class="n">c_mat_tmp</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">log_info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="c1"># Add global statistics</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="n">f1_weighted</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">acc_tot</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision_weighted</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall_weighted</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="s1">&#39;Trues&#39;</span><span class="p">:</span> <span class="n">trues</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="s1">&#39;Falses&#39;</span><span class="p">:</span> <span class="n">falses</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="s1">&#39;True positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="s1">&#39;True negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="s1">&#39;False positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="s1">&#39;False negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="s1">&#39;Condition positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="s1">&#39;Condition negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="s1">&#39;Predicted positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="s1">&#39;Predicted negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="p">}</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="n">df_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_df_stats</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="c1"># Add support</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>    <span class="n">df_stats</span><span class="p">[</span><span class="s1">&#39;Support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="c1"># Save .csv</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;f1</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">f1_weighted</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="n">df_stats</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="c1"># Save accuracy</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="n">acc_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;acc</span><span class="si">{</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">type_data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">type_data</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">acc_tot</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">acc_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">):</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>        <span class="k">pass</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="k">return</span> <span class="n">df_stats</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.get_classes_from_proba" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_classes_from_proba</span><span class="p">(</span><span class="n">predicted_proba</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets the classes from probabilities</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>predicted_proba</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The probabilities predicted by the model, shape = [n_samples, n_classes]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    predicted_class (np.ndarray): Shape = [n_samples, n_classes] if multi-labels, shape = [n_samples] otherwise</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="k">def</span> <span class="nf">get_classes_from_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicted_proba</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gets the classes from probabilities</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        predicted_proba (np.ndarray): The probabilities predicted by the model, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        predicted_class (np.ndarray): Shape = [n_samples, n_classes] if multi-labels, shape = [n_samples] otherwise</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">predicted_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span><span class="p">[</span><span class="n">x</span><span class="p">])(</span><span class="n">predicted_proba</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="c1"># If multi-labels, returns a list of 0 and 1</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">predicted_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">predicted_proba</span><span class="p">)</span>  <span class="c1"># 1 if x &gt; 0.5 else 0</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="k">return</span> <span class="n">predicted_class</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.get_metrics_simple_monolabel" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_metrics_simple_monolabel</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets metrics on mono-label predictions
Same as the method get_and_save_metrics but without all the fluff (save, etc.)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y_true</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_pred</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Raises:
    ValueError: If not in mono-label mode
Returns:
    pd.DataFrame: The dataframe containing statistics</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="k">def</span> <span class="nf">get_metrics_simple_monolabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gets metrics on mono-label predictions</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    Same as the method get_and_save_metrics but without all the fluff (save, etc.)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        y_true (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        y_pred (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        ValueError: If not in mono-label mode</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        pd.DataFrame: The dataframe containing statistics</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method get_metrics_simple_monolabel only works for the mono-label case&quot;</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="c1"># Cast to np.array</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="c1"># Check shapes</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_true</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="c1"># Gets global f1 score / acc_tot / trues / falses / precision / recall / support</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">f1_weighted</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="n">trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span> <span class="o">==</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="n">falses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_true</span> <span class="o">!=</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="n">acc_tot</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">precision_weighted</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">recall_weighted</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="n">labels_tmp</span><span class="p">,</span> <span class="n">counts_tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">support</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">):</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="k">if</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">labels_tmp</span><span class="p">:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="n">idx_tmp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">labels_tmp</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="n">support</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">counts_tmp</span><span class="p">[</span><span class="n">idx_tmp</span><span class="p">]</span> <span class="o">/</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="c1"># DataFrame metrics</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">dict_df_stats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="c1"># Get stats per class</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">label_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>  <span class="c1"># Fix : If label is an int, can cause some problems (e.g. only zeroes in the confusion matrix)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="n">none_class</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span> <span class="k">if</span> <span class="n">label_str</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span> <span class="k">else</span> <span class="s1">&#39;others&#39;</span>  <span class="c1"># Check that the class is not already &#39;None&#39;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="n">y_true_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_str</span> <span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">none_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">y_true</span><span class="p">]</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">y_pred_tmp</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_str</span> <span class="k">if</span> <span class="n">_</span> <span class="o">==</span> <span class="n">label</span> <span class="k">else</span> <span class="n">none_class</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="p">]</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">c_mat_tmp</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true_tmp</span><span class="p">,</span> <span class="n">y_pred_tmp</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">none_class</span><span class="p">,</span> <span class="n">label_str</span><span class="p">])</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_info_from_c_mat</span><span class="p">(</span><span class="n">c_mat_tmp</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">log_info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="c1"># Add global statistics</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="n">f1_weighted</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">acc_tot</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision_weighted</span><span class="p">,</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall_weighted</span><span class="p">,</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="s1">&#39;Trues&#39;</span><span class="p">:</span> <span class="n">trues</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="s1">&#39;Falses&#39;</span><span class="p">:</span> <span class="n">falses</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="s1">&#39;True positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="s1">&#39;True negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="s1">&#39;False positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="s1">&#39;False negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="s1">&#39;Condition positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="s1">&#39;Condition negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="s1">&#39;Predicted positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="s1">&#39;Predicted negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="p">}</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="n">df_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_df_stats</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="c1"># Add support</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="n">df_stats</span><span class="p">[</span><span class="s1">&#39;Support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="c1"># Return dataframe</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="k">return</span> <span class="n">df_stats</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.get_metrics_simple_multilabel" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_metrics_simple_multilabel</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets metrics on multi-label predictions
Same as the method get_and_save_metrics but without all the fluff (save, etc.)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y_true</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_pred</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Raises:
    ValueError: If not with multi-labels tasks
Returns:
    pd.DataFrame: The dataframe containing statistics</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="k">def</span> <span class="nf">get_metrics_simple_multilabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gets metrics on multi-label predictions</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    Same as the method get_and_save_metrics but without all the fluff (save, etc.)</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        y_true (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        y_pred (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        ValueError: If not with multi-labels tasks</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        pd.DataFrame: The dataframe containing statistics</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method get_metrics_simple_multilabel only works for multi-labels cases&quot;</span><span class="p">)</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="c1"># Cast to np.array</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="n">y_true</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="c1"># Gets global f1 score / acc_tot / trues / falses / precision / recall / support</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="n">f1_weighted</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="n">trues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="n">falses</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span> <span class="o">-</span> <span class="n">trues</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="n">acc_tot</span> <span class="o">=</span> <span class="n">trues</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="n">precision_weighted</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="n">recall_weighted</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="n">support</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>    <span class="n">support</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">support</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">support</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="c1"># DataFrame metrics</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="n">dict_df_stats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="c1"># Add metrics</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="c1"># Details per category</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">mcm</span> <span class="o">=</span> <span class="n">multilabel_confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">c_mat</span> <span class="o">=</span> <span class="n">mcm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_info_from_c_mat</span><span class="p">(</span><span class="n">c_mat</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">log_info</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>    <span class="c1"># Add global statistics</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="n">dict_df_stats</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="s1">&#39;All&#39;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="n">f1_weighted</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="n">acc_tot</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="n">precision_weighted</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="n">recall_weighted</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="s1">&#39;Trues&#39;</span><span class="p">:</span> <span class="n">trues</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="s1">&#39;Falses&#39;</span><span class="p">:</span> <span class="n">falses</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="s1">&#39;True positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="s1">&#39;True negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="s1">&#39;False positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>        <span class="s1">&#39;False negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="s1">&#39;Condition positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="s1">&#39;Condition negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="s1">&#39;Predicted positive&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="s1">&#39;Predicted negative&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="p">}</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="n">df_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">dict_df_stats</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="c1"># Add support</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="n">df_stats</span><span class="p">[</span><span class="s1">&#39;Support&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="c1"># Return dataframe</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>    <span class="k">return</span> <span class="n">df_stats</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.get_predict_position" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_predict_position</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets the order of predictions of y_true.
Positions start at 1 (not 0)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_test</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like or sparse matrix, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_true</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Raises:
    ValueError: Not available in multi-labels case
Returns:
    np.ndarray: Array, shape = [n_samples]</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="k">def</span> <span class="nf">get_predict_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gets the order of predictions of y_true.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    Positions start at 1 (not 0)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        x_test (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        y_true (?): Array-like, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        ValueError: Not available in multi-labels case</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        np.ndarray: Array, shape = [n_samples]</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method &#39;get_predict_position&#39;is unavailable in the multi-labels case&quot;</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="c1"># Process</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="c1"># Cast en pd.Series</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">y_true</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="c1"># Get predicted proba</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">predicted_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="c1"># Get position</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">order</span> <span class="o">=</span> <span class="n">predicted_proba</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">ranks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span> <span class="o">-</span> <span class="n">order</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">df_probas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="n">predict_positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">df_probas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">cl</span><span class="p">]</span> <span class="k">if</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">df_probas</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_true</span><span class="p">)])</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">return</span> <span class="n">predict_positions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.get_top_n_from_proba" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_top_n_from_proba</span><span class="p">(</span><span class="n">predicted_proba</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets the Top n predictions from probabilities</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>predicted_proba</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The probabilities predicted by the model, shape = [n_samples, n_classes]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>kwargs:
    n (int): Number of classes to return
Raises:
    ValueError: If the number of classes to return is greater than the number of classes of the model
Returns:
    list: top n predictions
    list: top n probabilities</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="k">def</span> <span class="nf">get_top_n_from_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicted_proba</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gets the Top n predictions from probabilities</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        predicted_proba (np.ndarray): The probabilities predicted by the model, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    kwargs:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        n (int): Number of classes to return</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        ValueError: If the number of classes to return is greater than the number of classes of the model</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        list: top n predictions</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        list: top n probabilities</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="c1"># TODO: Make this method available with multi-labels tasks</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method &#39;get_top_n_from_proba&#39; is unavailable with multi-labels tasks&quot;</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The number of classes to return is greater than the number of classes of the model&quot;</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="c1"># Process</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">idx</span> <span class="o">=</span> <span class="n">predicted_proba</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="o">-</span><span class="n">n</span><span class="p">:][:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">top_n_proba</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">predicted_proba</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">top_n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span><span class="p">[</span><span class="n">x</span><span class="p">])(</span><span class="n">idx</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="k">return</span> <span class="n">top_n</span><span class="p">,</span> <span class="n">top_n_proba</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.init_from_standalone_files" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">init_from_standalone_files</span><span class="p">(</span><span class="n">model_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Init. a new model from a config file and standalone files.</p>
<p>The main purpose of this function is to be able to use an old model trained with an old version which is not
unpicklable anymore.
We should be able to recreate a new class object as this library tries to save all infos in a configuration file,
and all models / tokenizers / etc. in standalone files.</p>
<p>The standalone files will be inferred from the model_dir argument, except if specific <strong>kwargs are provided.
To see which kwargs are available for your model, checks it's own <code>_load_standalone_files</code> function.
Of course, the function will raise an error if <code>model_dir</code> is None and no </strong>kwargs arguments are provided.</p>

<details class="warning-" open>
  <summary>It will create a new folder for the reloaded model and copy many files in this new folder.</summary>
  <p>That may take some space in your hard disk.</p>
</details>      <p>WARNING : This function should be called with the class of the model to be reloaded.
          e.g. ModelEmbeddingLstm.init_from_standalone_files(...)</p>

<details class="kwargs" open>
  <summary>Kwargs</summary>
  <p>model_dir (str): Absolute path of the folder containing the model to load.
                 If None, config_path must be set.
config_path (str): Absolute path to a configuration file.
                   If None, backups on the model_dir defaults configuration file.
                   If None, model_dir must be set.</p>
</details>      <p>Raises:
    ValueError: If both model_dir and config_path are None.
Returns:
    ModelClass: The loaded model
    dict: The model configuration</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a><span class="k">def</span> <span class="nf">init_from_standalone_files</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Init. a new model from a config file and standalone files.</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">    The main purpose of this function is to be able to use an old model trained with an old version which is not</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">    unpicklable anymore.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a><span class="sd">    We should be able to recreate a new class object as this library tries to save all infos in a configuration file,</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">    and all models / tokenizers / etc. in standalone files.</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">    The standalone files will be inferred from the model_dir argument, except if specific **kwargs are provided.</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">    To see which kwargs are available for your model, checks it&#39;s own `_load_standalone_files` function.</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">    Of course, the function will raise an error if `model_dir` is None and no **kwargs arguments are provided.</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">    WARNING : It will create a new folder for the reloaded model and copy many files in this new folder.</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">              That may take some space in your hard disk.</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">    WARNING : This function should be called with the class of the model to be reloaded.</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">              e.g. ModelEmbeddingLstm.init_from_standalone_files(...)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a><span class="sd">        model_dir (str): Absolute path of the folder containing the model to load.</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="sd">                         If None, config_path must be set.</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="sd">        config_path (str): Absolute path to a configuration file.</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a><span class="sd">                           If None, backups on the model_dir defaults configuration file.</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">                           If None, model_dir must be set.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">        ValueError: If both model_dir and config_path are None.</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        ModelClass: The loaded model</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">        dict: The model configuration</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>    <span class="k">if</span> <span class="n">model_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either model_dir or config_path must be set&quot;</span><span class="p">)</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>    <span class="c1"># First load the model configurations</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>    <span class="n">configs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_configs</span><span class="p">(</span><span class="n">model_dir</span><span class="o">=</span><span class="n">model_dir</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">)</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>    <span class="c1"># Init model from configurations</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_init_new_instance_from_configs</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="c1"># Load standalone files</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="n">model</span><span class="o">.</span><span class="n">_load_standalone_files</span><span class="p">(</span><span class="n">default_model_dir</span><span class="o">=</span><span class="n">model_dir</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>    <span class="c1"># Set configs to new model dir</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>    <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;model_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">model_dir</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="c1"># Return model</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">configs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.inverse_transform" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Gets a list of classes from the predictions</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>y</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like, shape = [n_samples, n_classes], arrays of 0s and 1s
   OR 1D array shape = [n_classes] (only one prediction)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Raises:
    ValueError: If the size of y does not correspond to the number of classes of the model
Returns:
    List of tuple if multi-labels and several predictions
    Tuple if multi-labels and one prediction
    List of classes if mono-label</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="k">def</span> <span class="nf">inverse_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Gets a list of classes from the predictions</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        y (?): Array-like, shape = [n_samples, n_classes], arrays of 0s and 1s</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">               OR 1D array shape = [n_classes] (only one prediction)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        ValueError: If the size of y does not correspond to the number of classes of the model</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        List of tuple if multi-labels and several predictions</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        Tuple if multi-labels and one prediction</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        List of classes if mono-label</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>    <span class="c1"># If multi-label, get classes in tuple</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="c1"># Cast to np array</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">):</span>  <span class="c1"># We consider &quot;-1&quot; in order to take care of the case where y is 1D</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The size of y (</span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">) does not correspond&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                             <span class="sa">f</span><span class="s2">&quot; to the number of classes of the model : (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="c1"># Manage 1D array (only one pred)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="c1"># TODO : shoudln&#39;t we return a list here ?</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="c1"># Several preds</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="k">return</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">)</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">indicators</span><span class="p">))</span> <span class="k">for</span> <span class="n">indicators</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="c1"># If mono-label, just cast in list if y is np array</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">else</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.load_configs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_configs</span><span class="p">(</span><span class="n">model_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Loads a model's configuration file as a dictionary</p>

<details class="kwargs" open>
  <summary>Kwargs</summary>
  <p>model_dir (str): Absolute path of the model.
                 Can be None to load a configuration path as it is, but config_path can't also be None.
config_path (str): Absolute path to a configuration file. Backup on the model_dir defaults configuration file.
                   Most of the time, you should leave this empty.</p>
</details>      <p>Raises:
    ValueError: If both model_dir and config_path are None.
Returns:
    dict: A model's configurations</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="k">def</span> <span class="nf">load_configs</span><span class="p">(</span><span class="n">model_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Loads a model&#39;s configuration file as a dictionary</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        model_dir (str): Absolute path of the model.</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">                         Can be None to load a configuration path as it is, but config_path can&#39;t also be None.</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">        config_path (str): Absolute path to a configuration file. Backup on the model_dir defaults configuration file.</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">                           Most of the time, you should leave this empty.</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">        ValueError: If both model_dir and config_path are None.</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">        dict: A model&#39;s configurations</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>    <span class="c1"># Manage errors</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>    <span class="k">if</span> <span class="n">model_dir</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;model_dir and config_path can&#39;t both be None in load_configs function&quot;</span><span class="p">)</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>    <span class="c1"># Get configurations</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>    <span class="n">configuration_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_dir</span><span class="p">,</span> <span class="s1">&#39;configurations.json&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">config_path</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">configuration_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>        <span class="n">configs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="c1"># Can&#39;t set int as keys in json, so need to cast it after reloading</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>    <span class="c1"># dict_classes keys are always ints</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>    <span class="k">if</span> <span class="s1">&#39;dict_classes&#39;</span> <span class="ow">in</span> <span class="n">configs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;dict_classes&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;dict_classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="n">col</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;dict_classes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>    <span class="k">elif</span> <span class="s1">&#39;list_classes&#39;</span> <span class="ow">in</span> <span class="n">configs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;list_classes&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;dict_classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">col</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="s1">&#39;list_classes&#39;</span><span class="p">])}</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="c1"># Return configs</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>    <span class="k">return</span> <span class="n">configs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.load_model" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_model</span><span class="p">(</span><span class="n">model_dir</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Loads a model from a path or a model name</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model_dir</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Absolute path of the folder containing the model to load</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Kwargs:
    config_path (str): Absolute path to a configuration file. Backup on the model_dir defaults configuration file.
                       Most of the time, you should leave this empty.
Returns:
    ModelClass: The loaded model
    dict: The model configuration</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="k">def</span> <span class="nf">load_model</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Loads a model from a path or a model name</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">        model_dir (str): Absolute path of the folder containing the model to load</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">        config_path (str): Absolute path to a configuration file. Backup on the model_dir defaults configuration file.</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">                           Most of the time, you should leave this empty.</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">        ModelClass: The loaded model</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">        dict: The model configuration</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="c1"># First load the model configurations</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>    <span class="n">configs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_configs</span><span class="p">(</span><span class="n">model_dir</span><span class="o">=</span><span class="n">model_dir</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">)</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="c1"># Load the model object from a pickle file</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="n">pkl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">configs</span><span class="p">[</span><span class="s1">&#39;model_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pkl_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>    <span class="c1"># Change model_dir to the input model_dir (usually when the model has been trained on another computer)</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>    <span class="n">configs</span><span class="p">[</span><span class="s1">&#39;model_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_dir</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>    <span class="n">model</span><span class="o">.</span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">model_dir</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>    <span class="c1"># Post load specificities</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>    <span class="n">model</span><span class="o">.</span><span class="n">_hook_post_load_model_pkl</span><span class="p">()</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>    <span class="c1"># Display if GPU is being used</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>    <span class="n">model</span><span class="o">.</span><span class="n">display_if_gpu_activated</span><span class="p">()</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>    <span class="c1"># Return model</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">configs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.predict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Predictions on the test set</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_test</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like or sparse matrix, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    (np.ndarray): Array, shape = [n_samples, n_classes]</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="nd">@utils</span><span class="o">.</span><span class="n">data_agnostic_str_to_list</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Predictions on the test set</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        x_test (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        (np.ndarray): Array, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&#39;predict&#39; needs to be overridden&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.predict_proba" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Predicts probabilities on the test dataset</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_test</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like or sparse matrix, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    (np.ndarray): Array, shape = [n_samples, n_classes]</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="nd">@utils</span><span class="o">.</span><span class="n">data_agnostic_str_to_list</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Predicts probabilities on the test dataset</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        x_test (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        (np.ndarray): Array, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;&#39;predict_proba&#39; needs to be overridden&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.predict_with_proba" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict_with_proba</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Predicts on the test set with probabilities</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_test</code></td>
          <td>
                <code>?</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Array-like or sparse matrix, shape = [n_samples, n_features]</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Returns:
    predicted_class (np.ndarray): The predicted classes, shape = [n_samples, n_classes]
    predicted_proba (np.ndarray): The predicted probabilities for each class, shape = [n_samples, n_classes]</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="nd">@utils</span><span class="o">.</span><span class="n">trained_needed</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="k">def</span> <span class="nf">predict_with_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Predicts on the test set with probabilities</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        x_test (?): Array-like or sparse matrix, shape = [n_samples, n_features]</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        predicted_class (np.ndarray): The predicted classes, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        predicted_proba (np.ndarray): The predicted probabilities for each class, shape = [n_samples, n_classes]</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="c1"># Process</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">predicted_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">return_proba</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">predicted_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_classes_from_proba</span><span class="p">(</span><span class="n">predicted_proba</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="k">return</span> <span class="n">predicted_class</span><span class="p">,</span> <span class="n">predicted_proba</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.reload_from_standalone" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">reload_from_standalone</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Deprecated</p>

          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-935" name="__codelineno-0-935"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="k">def</span> <span class="nf">reload_from_standalone</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Deprecated&#39;&#39;&#39;</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DEPRECATED : use load_model class method instead&quot;</span><span class="p">)</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="template_nlp.models_training.model_class.ModelClass.save" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">json_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Saves the model</p>

<details class="kwargs" open>
  <summary>Kwargs</summary>
  <p>json_data (dict): Additional configurations to be saved</p>
</details>
          <details class="quote">
            <summary>Source code in <code>template_nlp/models_training/model_class.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-702" name="__codelineno-0-702"></a><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Saves the model</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="sd">    Kwargs:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">        json_data (dict): Additional configurations to be saved</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">    &#39;&#39;&#39;</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>    <span class="c1"># Manage paths</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="n">pkl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.pkl&quot;</span><span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="n">conf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span> <span class="s2">&quot;configurations.json&quot;</span><span class="p">)</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="c1"># Save the model if level_save &gt; &#39;LOW&#39;</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MEDIUM&#39;</span><span class="p">,</span> <span class="s1">&#39;HIGH&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pkl_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="c1"># Save configuration JSON</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="s1">&#39;maintainers&#39;</span><span class="p">:</span> <span class="s1">&#39;Agence DataServices&#39;</span><span class="p">,</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="s1">&#39;gabarit_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.3.4.dev0+local&#39;</span><span class="p">,</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y - %H:%M:%S&quot;</span><span class="p">),</span>  <span class="c1"># Not the same as the folder&#39;s name</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="s1">&#39;package_version&#39;</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_package_version</span><span class="p">(),</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="s1">&#39;model_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="s1">&#39;model_dir&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_dir</span><span class="p">,</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="s1">&#39;trained&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trained</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="s1">&#39;nb_fit&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_fit</span><span class="p">,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="s1">&#39;list_classes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_classes</span><span class="p">,</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>        <span class="s1">&#39;dict_classes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_classes</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="s1">&#39;x_col&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_col</span><span class="p">,</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="s1">&#39;y_col&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_col</span><span class="p">,</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>        <span class="s1">&#39;random_seed&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="p">,</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="s1">&#39;multi_label&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">multi_label</span><span class="p">,</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>        <span class="s1">&#39;level_save&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">level_save</span><span class="p">,</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>        <span class="s1">&#39;librairie&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>    <span class="p">}</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>    <span class="c1"># Merge json_data if not None</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>    <span class="k">if</span> <span class="n">json_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>        <span class="c1"># Priority given to json_data !</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>        <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">json_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">json_data</span><span class="p">}</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>    <span class="c1"># Add conf to attributes</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">json_dict</span> <span class="o">=</span> <span class="n">json_dict</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>    <span class="c1"># Save conf</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">conf_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json_dict</span><span class="p">,</span> <span class="n">json_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">NpEncoder</span><span class="p">)</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>    <span class="c1"># Now, save a properties file for the model upload</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_save_upload_properties</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy"], "search": "../../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>